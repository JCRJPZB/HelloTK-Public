System.register("chunks:///_virtual/AlertLbl.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Generator.ts"],(function(e){"use strict";var t,n,r,i,o,s,l,c,a,u;return{setters:[function(e){t=e.defineProperty,n=e.inheritsLoose,r=e.assertThisInitialized},function(e){i=e.cclegacy,o=e._decorator,s=e.Label,l=e.tween,c=e.v3,a=e.Component},function(e){u=e.Generator}],execute:function(){var f,g,p;i._RF.push({},"02386CL/INAE6RGI4YIrT9d","AlertLbl",void 0);var d=o.ccclass;o.property,e("AlertLbl",d("AlertLbl")((p=g=function(e){function i(n){var i;return i=e.call(this,n)||this,t(r(i),"gen",null),i.gen=u.getInstance(),i}return n(i,e),i.getInstance=function(){return i.ins||(i.ins=new i("AlertLbl")),i.ins},i.prototype.alert=function(e,t,n){if(this.gen){var r=this.gen.generator(t,"Alert_Label",n),i=null==r?void 0:r.getComponent(s);i&&(i.string=e),l(r).by(1,{position:c(0,150,0)},{easing:"fade"}).call((function(){null==r||r.destroy()})).start()}},i}(a),t(g,"ins",void 0),f=p))||f);i._RF.pop()}}}));

System.register("chunks:///_virtual/HpNum.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Err.ts","./Functions.ts"],(function(n){"use strict";var t,e,i,r,o,s,a,c,u,l,p;return{setters:[function(n){t=n.inheritsLoose,e=n.defineProperty,i=n.assertThisInitialized},function(n){r=n.cclegacy,o=n._decorator,s=n.Label,a=n.find,c=n.Camera,u=n.Component},function(n){l=n.Err},function(n){p=n.Functions}],execute:function(){var h;r._RF.push({},"029f87Zhc9Bba11wecL2YPI","HpNum",void 0);var m=o.ccclass;o.property,n("HpNum",m("HpNum")(h=function(n){function r(){for(var t,r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return t=n.call.apply(n,[this].concat(o))||this,e(i(t),"lbl",new s),e(i(t),"curHp",0),e(i(t),"camp",""),t}t(r,n);var o=r.prototype;return o.onLoad=function(){var n=this.getComponent(s);n?this.lbl=n:l.print("Node doesn't have component named 'Label'!",this.name,this.onLoad.name)},o.init=function(n,t,e){var i,r=this;if(this.lbl){this.curHp=n,this.lbl.string=p.numToStr(this.curHp),this.camp=e;var o=null===(i=a("/Main Camera"))||void 0===i?void 0:i.getComponent(c);this.scheduleOnce((function(){o?p.UIFllow3DNode(r.node,o,t):l.console("Can't find camera!",r.name,r.init.name)}),.1)}else l.console("Label hasn't initialized!",this.name,this.init.name)},o.changeHp=function(n){var t=this.curHp+n;return this.curHp=t>0?t:0,this.lbl.string=p.numToStr(this.curHp),t},o.getCamp=function(){return this.camp},r}(u))||h);r._RF.pop()}}}));

System.register("chunks:///_virtual/SignUp.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Err.ts","./Subscribe.ts","./LoginMsg.ts"],(function(n){"use strict";var t,i,o,e,s,l,r,c,g,d,u;return{setters:[function(n){t=n.inheritsLoose,i=n.defineProperty,o=n.assertThisInitialized},function(n){e=n.cclegacy,s=n._decorator,l=n.EditBox,r=n.Button,c=n.Component},function(n){g=n.Err},function(n){d=n.Subscribe},function(n){u=n.LoginMsg}],execute:function(){var _;e._RF.push({},"0521djfz5hPkpHOEwNXbvWb","SignUp",void 0);var a=s.ccclass;s.property,n("SignUp",a("SignUp")(_=function(n){function e(){for(var t,e=arguments.length,s=new Array(e),l=0;l<e;l++)s[l]=arguments[l];return t=n.call.apply(n,[this].concat(s))||this,i(o(t),"ac_ed_box",null),i(o(t),"pw_ed_bix",null),i(o(t),"regist_btn",null),i(o(t),"login_btn",null),t}t(e,n);var s=e.prototype;return s.onLoad=function(){var n,t,i,o,e,s=this;this.ac_ed_box=null===(n=this.node.getChildByName("Ac_ed_box"))||void 0===n?void 0:n.getComponent(l),this.pw_ed_bix=null===(t=this.node.getChildByName("Pw_ed_box"))||void 0===t?void 0:t.getComponent(l),this.regist_btn=null===(i=this.node.getChildByName("Regist"))||void 0===i?void 0:i.getComponent(r),this.login_btn=null===(o=this.node.getChildByName("Login"))||void 0===o?void 0:o.getComponent(r),null===(e=this.login_btn)||void 0===e||e.node.on("click",(function(){s.ac_ed_box&&s.pw_ed_bix&&s.regist_btn&&s.login_btn?s.login(s.ac_ed_box.string,s.pw_ed_bix.string):g.alert("严重错误！请检查各节点名称！",s.name,s.login.name)}))},s.login=function(n,t){u.login_test()&&(d.trigger("login success"),this.node.active=!1)},s.regist=function(){},e}(c))||_);e._RF.pop()}}}));

System.register("chunks:///_virtual/Gesture.ts",["cc"],(function(){"use strict";var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"0e731+tczZBD4xyIdUQzmV9","Gesture",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/ResMgr.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Err.ts","./Subscribe.ts","./Configure.ts"],(function(e){"use strict";var n,o,t,r,a,u,s,i,l,d;return{setters:[function(e){n=e.defineProperty,o=e.inheritsLoose},function(e){t=e.cclegacy,r=e._decorator,a=e.resources,u=e.assetManager,s=e.Component},function(e){i=e.Err},function(e){l=e.Subscribe},function(e){d=e.Configure}],execute:function(){var c,f,p;t._RF.push({},"0ef46VNddxJSqnQ0y8rYn5y","ResMgr",void 0);var g=r.ccclass;r.property,e("ResMgr",g("ResMgr")((p=f=function(e){function n(){return e.apply(this,arguments)||this}return o(n,e),n.prototype.onLoad=function(){try{a.preloadDir("/")}catch(e){return void i.print(e,this.name,this.onLoad.name)}n.bundle_map.set("resources",a),l.trigger("resources loaded"),l.listen("settings loaded",this.name,n.loadBundle,this)},n.loadBundle=function(){var e=d.getConfigure("bundle_list").bundles;if(e){var o=e.length;e.forEach((function(e){u.loadBundle(e,(function(t,r){t?i.print(t.message,n.name,n.loadBundle.name):(n.bundle_map.set(e,r),--o<1&&l.trigger("bundle loaded"))}))}))}else i.alert("未知错误!",this.name,this.loadBundle.name)},n.loadRes=function(e,o,t,r,a,u,s){var l=n.bundle_map.get(e);l?l.load(o,t,null,(function(e,n){if(e)return i.console(e.message,a,u),void r(null,s);r(n,s)})):i.print("Bundle not found: "+e,n.name,n.loadRes.name)},n.loadDir=function(e,o,t,r,a,u,s){var l=n.bundle_map.get(e);l?l.loadDir(o,t,(function(e,n){if(e)return i.console(e.message,a,u),void r(null,s);r(n,s)})):i.print("Bundle not found: "+e,n.name,n.loadRes.name)},n.preLoad=function(e,o,t){var r=n.bundle_map.get(e);r?r.preload(o,t):i.console("Bundle not found: "+e,n.name,n.loadRes.name)},n}(s),n(f,"bundle_map",new Map),c=p))||c);t._RF.pop()}}}));

System.register("chunks:///_virtual/LoginMsg.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Err.ts","./Subscribe.ts","./Configure.ts","./MD5.ts"],(function(n){"use strict";var t,e,o,s,i,r,c,u;return{setters:[function(n){t=n.inheritsLoose},function(n){e=n.cclegacy,o=n._decorator,s=n.Component},function(n){i=n.Err},function(n){r=n.Subscribe},function(n){c=n.Configure},function(n){u=n.MD5}],execute:function(){var g;e._RF.push({},"1baf6txLnhNJIGGwD6DATCN","LoginMsg",void 0);var l=o.ccclass;o.property,n("LoginMsg",l("LoginMsg")(g=function(n){function e(){return n.apply(this,arguments)||this}t(e,n);var o=e.prototype;return o.onLoad=function(){r.listen("settings loaded",this.node.uuid,(function(){}))},e.login_test=function(){return!0},o.login=function(n,t,e,o,s){r.trigger("login success","");var i=u.md5(t),c=JSON.parse("{}");c.userId=n,c.pwCode=i,c.datetime=e.toString(),c.platform=o,c.others=s,console.log(JSON.stringify(c)),console.log(u.md5(JSON.stringify(c)))},o.parseMsg=function(n,t,e,o,s){var r=c.getConfigure("base").VerifyKey;if(r){var g=u.md5(n+t.toString()+e+s+r);console.log(g),g===o?console.log("Success."):console.log("Failed.")}else i.alert("Can't get the verify key!",this.name,this.parseMsg.name)},e}(s))||g);e._RF.pop()}}}));

System.register("chunks:///_virtual/UserException.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var e,r,n,o;return{setters:[function(t){e=t.inheritsLoose},function(t){r=t.cclegacy,n=t._decorator,o=t.Component}],execute:function(){var c;r._RF.push({},"1fb57XsV7JEqLEe2HE/kC62","UserException",void 0);var s=n.ccclass;n.property,t("UserException",s("UserException")(c=function(t){function r(){return t.apply(this,arguments)||this}return e(r,t),r.prototype.start=function(){},r}(o))||c);r._RF.pop()}}}));

System.register("chunks:///_virtual/StageMgr.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Configure.ts"],(function(t){"use strict";var e,r,n,o,s,a,c,i;return{setters:[function(t){e=t.defineProperty,r=t.inheritsLoose,n=t.assertThisInitialized,o=t.createClass},function(t){s=t.cclegacy,a=t._decorator,c=t.Component},function(t){i=t.Configure}],execute:function(){var g,u,f;s._RF.push({},"21b91aIK2VH7o5UfDdN/9e/","StageMgr",void 0);var l=a.ccclass;a.property,t("StageMgr",l("StageMgr")((f=u=function(t){function s(r){var o;return o=t.call(this,r)||this,e(n(o),"conf",void 0),e(n(o),"conf_map",new Map),e(n(o),"goals_str",void 0),o.conf=i.getConfigure("stage"),o.conf&&o.conf.stages.forEach((function(t){o.conf_map.set(t.id,t)})),o.goals_str=o.conf.goals,o}r(s,t),s.getInstance=function(){return s.ist||(s.ist=new s("StageMgr")),s.ist};var a=s.prototype;return a.getStageConf=function(t){return this.conf_map.get(t)},a.getStageGoal=function(t,e){var r=this,n=this.conf_map.get(t).stage[e],o=[];return n.goal.forEach((function(t){var e=t.split(":"),n=e[0],s=e[1];o.push(r.goals_str[n].replace(r.goals_str.replacement,s.toString()))})),o},o(s,[{key:"curr_stage",get:function(){return s.curr_stage},set:function(t){s.curr_stage=t}}]),s}(c),e(u,"ist",void 0),e(u,"curr_stage",""),g=f))||g);s._RF.pop()}}}));

System.register("chunks:///_virtual/MD5.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(r){"use strict";var n,t,o,e;return{setters:[function(r){n=r.inheritsLoose},function(r){t=r.cclegacy,o=r._decorator,e=r.Component}],execute:function(){var u;t._RF.push({},"25a71ODzcdIrbRBys+9/Vrd","MD5",void 0);var c=o.ccclass;o.property,r("MD5",c("MD5")(u=function(r){function t(){return r.apply(this,arguments)||this}return n(t,r),t.md5=function(r){function n(r,n){return r<<n|r>>>32-n}function t(r,n){var t,o,e,u,c;return e=2147483648&r,u=2147483648&n,c=(1073741823&r)+(1073741823&n),(t=1073741824&r)&(o=1073741824&n)?2147483648^c^e^u:t|o?1073741824&c?3221225472^c^e^u:1073741824^c^e^u:c^e^u}function o(r,o,e,u,c,i,f){return r=t(r,t(t(function(r,n,t){return r&n|~r&t}(o,e,u),c),f)),t(n(r,i),o)}function e(r,o,e,u,c,i,f){return r=t(r,t(t(function(r,n,t){return r&t|n&~t}(o,e,u),c),f)),t(n(r,i),o)}function u(r,o,e,u,c,i,f){return r=t(r,t(t(function(r,n,t){return r^n^t}(o,e,u),c),f)),t(n(r,i),o)}function c(r,o,e,u,c,i,f){return r=t(r,t(t(function(r,n,t){return n^(r|~t)}(o,e,u),c),f)),t(n(r,i),o)}function i(r){var n,t="",o="";for(n=0;n<=3;n++)t+=(o="0"+(r>>>8*n&255).toString(16)).substr(o.length-2,2);return t}var f,a,s,h,C,g,d,l,p,v=Array();for(v=function(r){for(var n,t=r.length,o=t+8,e=16*((o-o%64)/64+1),u=Array(e-1),c=0,i=0;i<t;)c=i%4*8,u[n=(i-i%4)/4]=u[n]|r.charCodeAt(i)<<c,i++;return c=i%4*8,u[n=(i-i%4)/4]=u[n]|128<<c,u[e-2]=t<<3,u[e-1]=t>>>29,u}(r=function(r){r=r.replace(/\r\n/g,"\n");for(var n="",t=0;t<r.length;t++){var o=r.charCodeAt(t);o<128?n+=String.fromCharCode(o):o>127&&o<2048?(n+=String.fromCharCode(o>>6|192),n+=String.fromCharCode(63&o|128)):(n+=String.fromCharCode(o>>12|224),n+=String.fromCharCode(o>>6&63|128),n+=String.fromCharCode(63&o|128))}return n}(r)),g=1732584193,d=4023233417,l=2562383102,p=271733878,f=0;f<v.length;f+=16)a=g,s=d,h=l,C=p,g=o(g,d,l,p,v[f+0],7,3614090360),p=o(p,g,d,l,v[f+1],12,3905402710),l=o(l,p,g,d,v[f+2],17,606105819),d=o(d,l,p,g,v[f+3],22,3250441966),g=o(g,d,l,p,v[f+4],7,4118548399),p=o(p,g,d,l,v[f+5],12,1200080426),l=o(l,p,g,d,v[f+6],17,2821735955),d=o(d,l,p,g,v[f+7],22,4249261313),g=o(g,d,l,p,v[f+8],7,1770035416),p=o(p,g,d,l,v[f+9],12,2336552879),l=o(l,p,g,d,v[f+10],17,4294925233),d=o(d,l,p,g,v[f+11],22,2304563134),g=o(g,d,l,p,v[f+12],7,1804603682),p=o(p,g,d,l,v[f+13],12,4254626195),l=o(l,p,g,d,v[f+14],17,2792965006),g=e(g,d=o(d,l,p,g,v[f+15],22,1236535329),l,p,v[f+1],5,4129170786),p=e(p,g,d,l,v[f+6],9,3225465664),l=e(l,p,g,d,v[f+11],14,643717713),d=e(d,l,p,g,v[f+0],20,3921069994),g=e(g,d,l,p,v[f+5],5,3593408605),p=e(p,g,d,l,v[f+10],9,38016083),l=e(l,p,g,d,v[f+15],14,3634488961),d=e(d,l,p,g,v[f+4],20,3889429448),g=e(g,d,l,p,v[f+9],5,568446438),p=e(p,g,d,l,v[f+14],9,3275163606),l=e(l,p,g,d,v[f+3],14,4107603335),d=e(d,l,p,g,v[f+8],20,1163531501),g=e(g,d,l,p,v[f+13],5,2850285829),p=e(p,g,d,l,v[f+2],9,4243563512),l=e(l,p,g,d,v[f+7],14,1735328473),g=u(g,d=e(d,l,p,g,v[f+12],20,2368359562),l,p,v[f+5],4,4294588738),p=u(p,g,d,l,v[f+8],11,2272392833),l=u(l,p,g,d,v[f+11],16,1839030562),d=u(d,l,p,g,v[f+14],23,4259657740),g=u(g,d,l,p,v[f+1],4,2763975236),p=u(p,g,d,l,v[f+4],11,1272893353),l=u(l,p,g,d,v[f+7],16,4139469664),d=u(d,l,p,g,v[f+10],23,3200236656),g=u(g,d,l,p,v[f+13],4,681279174),p=u(p,g,d,l,v[f+0],11,3936430074),l=u(l,p,g,d,v[f+3],16,3572445317),d=u(d,l,p,g,v[f+6],23,76029189),g=u(g,d,l,p,v[f+9],4,3654602809),p=u(p,g,d,l,v[f+12],11,3873151461),l=u(l,p,g,d,v[f+15],16,530742520),g=c(g,d=u(d,l,p,g,v[f+2],23,3299628645),l,p,v[f+0],6,4096336452),p=c(p,g,d,l,v[f+7],10,1126891415),l=c(l,p,g,d,v[f+14],15,2878612391),d=c(d,l,p,g,v[f+5],21,4237533241),g=c(g,d,l,p,v[f+12],6,1700485571),p=c(p,g,d,l,v[f+3],10,2399980690),l=c(l,p,g,d,v[f+10],15,4293915773),d=c(d,l,p,g,v[f+1],21,2240044497),g=c(g,d,l,p,v[f+8],6,1873313359),p=c(p,g,d,l,v[f+15],10,4264355552),l=c(l,p,g,d,v[f+6],15,2734768916),d=c(d,l,p,g,v[f+13],21,1309151649),g=c(g,d,l,p,v[f+4],6,4149444226),p=c(p,g,d,l,v[f+11],10,3174756917),l=c(l,p,g,d,v[f+2],15,718787259),d=c(d,l,p,g,v[f+9],21,3951481745),g=t(g,a),d=t(d,s),l=t(l,h),p=t(p,C);return(i(g)+i(d)+i(l)+i(p)).toLowerCase()},t}(e))||u);t._RF.pop()}}}));

System.register("chunks:///_virtual/GameMgr.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Subscribe.ts"],(function(e){"use strict";var t,n,r,s,o,i;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,r=e._decorator,s=e.director,o=e.Component},function(e){i=e.Subscribe}],execute:function(){var u;n._RF.push({},"279517QfXNMg4C3xbah+L+g","GameMgr",void 0);var c=r.ccclass;r.property,e("GameMgr",c("GameMgr")(u=function(e){function n(){return e.apply(this,arguments)||this}return t(n,e),n.prototype.onLoad=function(){i.listen("pause",this.name,(function(){s.pause()})),i.listen("resume",this.name,(function(){s.resume()}))},n}(o))||u);n._RF.pop()}}}));

System.register("chunks:///_virtual/MoveCamera.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Err.ts","./Subscribe.ts","./Configure.ts"],(function(t){"use strict";var e,s,a,i,n,c,r,o,h,u,l,_,m,f,g,v,x;return{setters:[function(t){e=t.defineProperty,s=t.inheritsLoose,a=t.assertThisInitialized},function(t){i=t.cclegacy,n=t._decorator,c=t.geometry,r=t.Vec3,o=t.systemEvent,h=t.SystemEvent,u=t.find,l=t.Camera,_=t.PhysicsSystem,m=t.v3,f=t.Component},function(t){g=t.Err},function(t){v=t.Subscribe},function(t){x=t.Configure}],execute:function(){var y,T,d;i._RF.push({},"27abeYjJkNK3IcFRq8cRSsm","MoveCamera",void 0);var p=n.ccclass,C=(n.property,c.Ray);t("MoveCamera",p("MoveCamera")((d=T=function(t){function i(s){var i;return i=t.call(this,s)||this,e(a(i),"conf",void 0),e(a(i),"curr_conf",void 0),e(a(i),"camera",null),e(a(i),"ray",new C),e(a(i),"max_x",0),e(a(i),"min_x",0),e(a(i),"max_z",0),e(a(i),"min_z",0),e(a(i),"pos",new r),e(a(i),"touch_dist",0),e(a(i),"scale",1),e(a(i),"max_scale",1),e(a(i),"min_scale",1),e(a(i),"safe_area",null),i.conf=x.getConfigure("base").camera_move,v.listen("change scene",i.name,i.changeScene,a(i)),o.on(h.EventType.TOUCH_START,i.onTouchStart,a(i)),o.on(h.EventType.TOUCH_MOVE,i.onTouchMove,a(i)),o.on(h.EventType.TOUCH_CANCEL,i.onTouchEnd,a(i)),o.on(h.EventType.TOUCH_END,i.onTouchEnd,a(i)),i.changeScene("StartScene",null),i}s(i,t),i.getInstance=function(){return i.ist||(i.ist=new i("MoveCamera")),i.ist};var n=i.prototype;return n.changeScene=function(t,e){this.curr_conf=this.conf[t],this.max_x=this.curr_conf.max_x,this.min_x=this.curr_conf.min_x,this.max_z=this.curr_conf.max_z,this.min_z=this.curr_conf.min_z,this.scale=1,this.max_scale=this.curr_conf.max_scale,this.min_scale=this.curr_conf.min_scale;var s=u("Main Camera");s?(this.camera=s.getComponent(l),this.safe_area=u("SafeArea")):g.console("Can't find Main Camera!",this.name,this.changeScene.name)},n.onTouchStart=function(t,e){if(this.curr_conf&&this.curr_conf.enable&&this.camera){var s=e.getAllTouches().length;1===s?(this.curr_conf.ray_cast&&this.rayCast(e,"start"),v.trigger("touch screen start")):2===s&&(this.touch_dist=e.getAllTouches()[0].getLocation().subtract(e.getAllTouches()[1].getLocation()).length())}},n.onTouchMove=function(t,e){if(this.curr_conf&&this.curr_conf.enable&&this.camera){var s=e.getAllTouches().length;if(2===s){var a=e.getAllTouches(),i=a[0].getLocation().subtract(a[1].getLocation()).length();this.scaleScene(i/this.touch_dist>1?1.01:.99)}else if(1===s){this.camera.node.getPosition(this.pos);var n=this.pos.x-.1*e.getDeltaX(),c=this.pos.z+.1*e.getDeltaY();this.pos.x=n>this.max_x?this.max_x:n<this.min_x?this.min_x:n,this.pos.z=c>this.max_z?this.max_z:c<this.min_z?this.min_z:c,this.camera.node.setPosition(this.pos)}}},n.onTouchEnd=function(t,e){this.curr_conf&&this.curr_conf.enable&&this.camera&&(this.curr_conf.ray_cast&&this.rayCast(e,"end"),e.getAllTouches().length<=1&&v.trigger("touch screen end"))},n.rayCast=function(t,e){if(this.camera&&(this.camera.screenPointToRay(t.getLocationX(),t.getLocationY(),this.ray),_.instance.raycast(this.ray))){var s=_.instance.raycastResults;if(s.length<=0)return;v.trigger("touch_"+e+s[0].collider.node.uuid),v.trigger("touch_"+e)}},n.scaleScene=function(t){if(this.safe_area){var e=this.scale;this.scale*=t,this.scale=this.scale<this.min_scale?this.min_scale:this.scale,this.scale=this.scale>this.max_scale?this.max_scale:this.scale,this.scale!=e*t&&(t=this.scale/e),this.safe_area.setScale(m(this.scale,this.scale,this.scale))}},i}(f),e(T,"ist",void 0),y=d))||y);i._RF.pop()}}}));

System.register("chunks:///_virtual/ItemMgr.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Configure.ts"],(function(t){"use strict";var e,n,r,o,i,c,s;return{setters:[function(t){e=t.defineProperty,n=t.inheritsLoose,r=t.assertThisInitialized},function(t){o=t.cclegacy,i=t._decorator,c=t.Component},function(t){s=t.Configure}],execute:function(){var u,f,a;o._RF.push({},"2bef4ydqjFJqbO7Ejx9GKkU","ItemMgr",void 0);var g=i.ccclass;i.property,t("ItemMgr",g("ItemMgr")((a=f=function(t){function o(n){var o;return o=t.call(this,n)||this,e(r(o),"conf",void 0),e(r(o),"conf_map",new Map),o.conf=s.getConfigure("items"),o.conf&&o.conf.items.forEach((function(t){o.conf_map.set(t.id,t)})),o}return n(o,t),o.getInstance=function(){return o.ist||(o.ist=new o("ItemMgr")),o.ist},o.prototype.getItemConf=function(t){return this.conf_map.get(t)},o}(c),e(f,"ist",null),u=a))||u);o._RF.pop()}}}));

System.register("chunks:///_virtual/Loading.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Subscribe.ts","./Generator.ts","./SceneMgr.ts"],(function(e){"use strict";var t,i,l,a,n,s,_,r,d,o;return{setters:[function(e){t=e.inheritsLoose,i=e.defineProperty,l=e.assertThisInitialized},function(e){a=e.cclegacy,n=e._decorator,s=e.Label,_=e.Component},function(e){r=e.Subscribe},function(e){d=e.Generator},function(e){o=e.SceneMgr}],execute:function(){var f;a._RF.push({},"2c163r0rQFM5oGD3vz4cIHR","Loading",void 0);var c=n.ccclass;n.property,e("Loading",c("Loading")(f=function(e){function a(){for(var t,a=arguments.length,n=new Array(a),s=0;s<a;s++)n[s]=arguments[s];return t=e.call.apply(e,[this].concat(n))||this,i(l(t),"start_btn",null),i(l(t),"load_lbl",null),i(l(t),"login_window",null),i(l(t),"test_enemy",{heros:[{id:"CaoCao_ally",name:"曹操",hero_id:"CaoCao",prefab:"General",level:60,hp:1800,atk:6e3,def:80,atkEff:"default_atk_particle",hitEff:"default_hit_particle",skill_name:"default",skillEff:"default_skill_particle",arms:"Cavalry_Lv1",is_sp:!1,is_select:!0,idx:0},{id:"LiuBei_ally",name:"刘备",hero_id:"LiuBei",prefab:"General",level:60,hp:1200,atk:8e3,def:50,atkEff:"default_atk_particle",hitEff:"default_hit_particle",skill_name:"default",skillEff:"default_skill_particle",arms:"Archer_Lv1",is_sp:!1,is_select:!0,idx:1},{id:"SunQuan_ally",name:"孙权",hero_id:"SunQuan",prefab:"General",level:60,hp:2400,atk:5500,def:100,atkEff:"default_atk_particle",hitEff:"default_hit_particle",skill_name:"default",skillEff:"default_skill_particle",arms:"Infantry_Lv1",is_sp:!1,is_select:!0,idx:2},{id:"LvBu_ally",hero_id:"LvBu",name:"吕布",prefab:"General",level:60,hp:2800,atk:5500,def:100,atkEff:"default_atk_particle",hitEff:"default_hit_particle",skill_name:"default",skillEff:"default_skill_particle",arms:"Infantry_Lv1",is_sp:!0,is_select:!0,idx:3},{id:"ZhugeLiang_ally",name:"诸葛亮",hero_id:"ZhugeLiang",prefab:"General",level:60,hp:1500,atk:7e3,def:80,atkEff:"default_atk_particle",hitEff:"default_hit_particle",skill_name:"default",skillEff:"default_skill_particle",arms:"Cavalry_Lv1",is_sp:!1,is_select:!0,idx:4},{id:"ZhouYu_ally",name:"周瑜",hero_id:"ZhouYu",prefab:"General",level:60,hp:1500,atk:7e3,def:80,atkEff:"default_atk_particle",hitEff:"default_hit_particle",skill_name:"default",skillEff:"default_skill_particle",arms:"Cavalry_Lv1",is_sp:!1,is_select:!1,idx:5}],formation:{id:"crescent",name:"偃月阵",pos_idxs:[1,2,3,5,6],introduce:"提高暴击率",ids_idxs:[{id:"CaoCao_ally",idx:0},{id:"LiuBei_ally",idx:1},{id:"SunQuan_ally",idx:2},{id:"LvBu_ally",idx:3},{id:"ZhugeLiang_ally",idx:4}]}}),t}return t(a,e),a.prototype.onLoad=function(){var e,t=this;this.start_btn=this.node.getChildByName("StartBtn"),this.load_lbl=null===(e=this.node.getChildByName("Loading"))||void 0===e?void 0:e.getComponent(s),this.login_window=this.node.getChildByName("Login_window"),this.start_btn&&this.load_lbl&&this.login_window&&(this.load_lbl.node.active=!0,this.login_window.active=!1,this.start_btn.active=!1,this.start_btn.on("click",(function(){o.getInstance().loadScene("Main","test_player")})),r.listen("StartScene loaded",this.name,(function(){t.load_lbl&&t.login_window&&(d.getInstance(),t.load_lbl.node.active=!1,t.login_window.active=!0)})),r.listen("login success",this.name,(function(){t.start_btn&&(t.start_btn.active=!0)})))},a}(_))||f);a._RF.pop()}}}));

System.register("chunks:///_virtual/MonsterMgr.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Configure.ts","./Functions.ts"],(function(t){"use strict";var n,e,r,o,s,i,c,a;return{setters:[function(t){n=t.defineProperty,e=t.inheritsLoose,r=t.assertThisInitialized},function(t){o=t.cclegacy,s=t._decorator,i=t.Component},function(t){c=t.Configure},function(t){a=t.Functions}],execute:function(){var u,f,p;o._RF.push({},"2d09ebAU+pGA4ocl2FaVvI5","MonsterMgr",void 0);var g=s.ccclass;s.property,t("MonsterMgr",g("MonsterMgr")((p=f=function(t){function o(e){var o;return o=t.call(this,e)||this,n(r(o),"conf",void 0),n(r(o),"conf_map",new Map),o.conf=c.getConfigure("monsters"),o.conf&&o.conf.monsters.forEach((function(t){o.conf_map.set(t.id,t)})),o}return e(o,t),o.getInstance=function(){return o.ist||(o.ist=new o("MonsterMgr")),o.ist},o.prototype.getMonsterAttr=function(t){var n=a.deepCopy(this.conf_map.get(t.mst_id));return n?(n.hp=n.base_hp+t.lv*n.grow_rate.hp,n.atk=n.base_atk+t.lv*n.grow_rate.atk,n.def=n.base_def+t.lv*n.grow_rate.def,n.pos=JSON.parse(JSON.stringify(t.pos)),n.id=JSON.parse(JSON.stringify(t.id)),n):null},o}(i),n(f,"ist",void 0),u=p))||u);o._RF.pop()}}}));

System.register("chunks:///_virtual/SceneMgr.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Err.ts","./Subscribe.ts"],(function(e){"use strict";var n,t,r,o,a,i,c,s,l,u,d;return{setters:[function(e){n=e.defineProperty,t=e.inheritsLoose,r=e.assertThisInitialized},function(e){o=e.cclegacy,a=e._decorator,i=e.director,c=e.find,s=e.ProgressBar,l=e.Component},function(e){u=e.Err},function(e){d=e.Subscribe}],execute:function(){var S,f,p;o._RF.push({},"317989VMTFALb13oDoZRKIy","SceneMgr",void 0);var g=a.ccclass;a.property,e("SceneMgr",g("SceneMgr")((p=f=function(e){function o(t){var o;return o=e.call(this,t)||this,n(r(o),"pb",null),o}t(o,e),o.getInstance=function(){return o.ist||(o.ist=new o("SceneMgr")),o.ist};var a=o.prototype;return a.loadScene=function(e,n){var t=this;i.loadScene("Loading",(function(){var r;t.pb=null===(r=c("/Canvas/ProgressBar"))||void 0===r?void 0:r.getComponent(s),t.loadStart(e,n)}))},a.loadStart=function(e,n){var t=this;try{i.preloadScene(e,(function(e,n,r){var o=e/n;t.pb?t.pb.progress=o:u.console("Load progress bar failed!",t.name,t.loadStart.name)}),(function(){i.loadScene(e,(function(){t.loadComplete(n)}))}))}catch(n){u.console("Can't find scene named: "+e,this.name,this.loadStart.name),this.returnToStart()}},a.loadComplete=function(e){var n,t=null===(n=i.getScene())||void 0===n?void 0:n.name;if(!t)return u.console("Load scene error!",this.name,this.loadComplete.name),void this.returnToStart();d.trigger("change scene",t,e)},a.returnToStart=function(){this.loadScene("StartScene",null)},o}(l),n(f,"ist",null),S=p))||S);o._RF.pop()}}}));

System.register("chunks:///_virtual/MainScene.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Subscribe.ts","./SceneMgr.ts"],(function(t){"use strict";var n,e,i,o,c,r,a,s;return{setters:[function(t){n=t.inheritsLoose,e=t.defineProperty,i=t.assertThisInitialized},function(t){o=t.cclegacy,c=t._decorator,r=t.Component},function(t){a=t.Subscribe},function(t){s=t.SceneMgr}],execute:function(){var u;o._RF.push({},"36774Cr/8xIB6VbQGB+A52e","MainScene",void 0);var l=c.ccclass;c.property,t("MainScene",l("MainScene")(u=function(t){function o(){for(var n,o=arguments.length,c=new Array(o),r=0;r<o;r++)c[r]=arguments[r];return n=t.call.apply(t,[this].concat(c))||this,e(i(n),"formation_btn",null),e(i(n),"battle_btn",null),e(i(n),"data",{}),n}n(o,t);var c=o.prototype;return c.onLoad=function(){a.listen("change scene",this.name,(function(t,n){})),this.battle_btn=this.node.getChildByPath("Btns_Root/Option_Btns_Root/Layout/Battle")},c.start=function(){var t;null===(t=this.battle_btn)||void 0===t||t.on("click",(function(){s.getInstance().loadScene("Expedition","main")}))},o}(r))||u);o._RF.pop()}}}));

System.register("chunks:///_virtual/HeroPortrait.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Subscribe.ts","./ResMgr.ts"],(function(e){"use strict";var t,i,s,l,r,n,h,c,o,a,d;return{setters:[function(e){t=e.inheritsLoose,i=e.defineProperty,s=e.assertThisInitialized},function(e){l=e.cclegacy,r=e._decorator,n=e.Sprite,h=e.Label,c=e.SpriteFrame,o=e.Component},function(e){a=e.Subscribe},function(e){d=e.ResMgr}],execute:function(){var _;l._RF.push({},"3bcafz2LplDxJOtLiXDg9si","HeroPortrait",void 0);var p=r.ccclass;r.property,e("HeroPortrait",p("HeroPortrait")(_=function(e){function l(){for(var t,l=arguments.length,r=new Array(l),n=0;n<l;n++)r[n]=arguments[n];return t=e.call.apply(e,[this].concat(r))||this,i(s(t),"id",""),i(s(t),"unselected",null),i(s(t),"selected",null),i(s(t),"select_trigger",null),i(s(t),"is_select",!1),i(s(t),"portrait",null),i(s(t),"name_lbl",null),i(s(t),"lv_lbl",null),i(s(t),"sp_trigger",null),i(s(t),"sp_disable",null),i(s(t),"sp_enable",null),i(s(t),"is_sp",!1),t}t(l,e);var r=l.prototype;return r.onLoad=function(){var e,t,i,s,l;this.unselected=this.node.getChildByName("Border_unselected"),this.selected=this.node.getChildByName("Border_selected"),this.select_trigger=this.node.getChildByName("Select_trigger"),this.portrait=null===(e=this.node.getChildByName("Portrait"))||void 0===e?void 0:e.getComponent(n),this.name_lbl=null===(t=this.node.getChildByName("Name"))||void 0===t?void 0:t.getComponent(h),this.lv_lbl=null===(i=this.node.getChildByName("Lv_Label"))||void 0===i?void 0:i.getComponent(h),this.sp_trigger=this.node.getChildByName("Sp_trigger"),this.sp_disable=null===(s=this.sp_trigger)||void 0===s?void 0:s.getChildByName("Sp_disable"),this.sp_enable=null===(l=this.sp_trigger)||void 0===l?void 0:l.getChildByName("Sp_enable")},r.init=function(e){var t=this;this.id=e.id,this.is_select=e.is_select,this.selected&&this.unselected&&(this.selected.active=this.is_select,this.unselected.active=!this.is_select),this.select_trigger&&this.select_trigger.on("click",(function(){a.trigger("change hero selected",t.id,t.is_select,t.changeSelected.bind(t))})),this.name_lbl&&(this.name_lbl.string=e.name),this.lv_lbl&&(this.lv_lbl.string="Lv."+e.level),this.is_sp=e.is_sp,this.sp_disable&&this.sp_enable&&this.sp_trigger&&(this.sp_trigger.on("click",this.changeSphero,this),this.sp_disable.active=!this.is_sp,this.sp_enable.active=this.is_sp),d.loadDir("Texture","Portrait/Hero/"+e.hero_id,c,(function(e){t.portrait&&e&&(t.portrait.spriteFrame=e[0])}),this.name,this.init.name)},r.changeSelected=function(){this.selected&&this.unselected&&(this.is_select=!this.is_select,this.selected.active=this.is_select,this.unselected.active=!this.is_select)},r.changeSphero=function(){this.sp_disable&&this.sp_enable&&(this.is_sp=!this.is_sp,this.sp_disable.active=!this.is_sp,this.sp_enable.active=this.is_sp,a.trigger("changeSpHero",this.id,this.is_sp))},l}(o))||_);l._RF.pop()}}}));

System.register("chunks:///_virtual/HpMgr.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Err.ts","./Subscribe.ts","./Generator.ts","./HpNum.ts","./TotalHp.ts"],(function(t){"use strict";var n,e,o,a,i,r,s,p,u,c,l,h;return{setters:[function(t){n=t.defineProperty,e=t.inheritsLoose,o=t.assertThisInitialized},function(t){a=t.cclegacy,i=t._decorator,r=t.find,s=t.Component},function(t){p=t.Err},function(t){u=t.Subscribe},function(t){c=t.Generator},function(t){l=t.HpNum},function(t){h=t.TotalHp}],execute:function(){var m,g,f;a._RF.push({},"3dbc6+ZAn1FwbXbUyeKJFSa","HpMgr",void 0);var _=i.ccclass;i.property,t("HpMgr",_("HpMgr")((f=g=function(t){function a(e){var a;return a=t.call(this,e)||this,n(o(a),"gen",null),n(o(a),"num_map",new Map),n(o(a),"hero_map",new Map),a.gen=c.getInstance(),u.listen("change hp",a.name,a.changeHp,o(a)),a}e(a,t),a.getInstance=function(){var t;return a.ist||(a.ist=new a("HpMgr")),a.num_root=r("/Canvas/Battle/HpBars"),a.total_hp=null===(t=r("/Canvas/Battle/TotalHp"))||void 0===t?void 0:t.getComponent(h),a.ist};var i=a.prototype;return i.reset=function(){this.num_map.clear()},i.genHpNum=function(t,n){if(this.gen&&a.num_root){var e=this.gen.generator(a.num_root,"HpNum"),o=null==e?void 0:e.getComponent(l);o?(o.init(t.getConf("hp"),t.node,n),this.num_map.set(t.id,o),this.hero_map.set(t.id,t)):p.console("Component doesn't exist!",this.name,this.genHpNum.name)}},i.init_total_hp=function(t,n){if(a.total_hp){var e=t.heros,o=0;e.forEach((function(t){o+=t.hp})),a.total_hp.set_hp(o,n)}},i.changeHp=function(t,n){var e=this.num_map.get(t);if(e){var o=e.changeHp(n);o<=0&&(this.heroDie(t),n-=o),a.total_hp&&a.total_hp.changeHp(n,e.getCamp())}else p.console("Can't find "+t+"'s hp bar!",this.name,this.changeHp.name)},i.heroDie=function(t){var n=this;this.scheduleOnce((function(){u.trigger("hero die",n.hero_map.get(t));var e=n.num_map.get(t);e&&(e.node.parent=null),n.num_map.delete(t),n.hero_map.delete(t)}),1)},i.onDestroy=function(){this.unscheduleAllCallbacks()},a}(s),n(g,"ist",null),n(g,"num_root",null),n(g,"total_hp",null),m=f))||m);a._RF.pop()}}}));

System.register("chunks:///_virtual/StageDetails.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Subscribe.ts","./ResMgr.ts","./Generator.ts","./Functions.ts","./StageMgr.ts","./ItemMgr.ts","./SceneMgr.ts"],(function(t){"use strict";var e,n,i,r,s,o,a,l,g,h,c,m,u,d,p,_,v,f;return{setters:[function(t){e=t.inheritsLoose,n=t.defineProperty,i=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,o=t.Label,a=t.UITransform,l=t.Size,g=t.Sprite,h=t.SpriteFrame,c=t.Component},function(t){m=t.Subscribe},function(t){u=t.ResMgr},function(t){d=t.Generator},function(t){p=t.Functions},function(t){_=t.StageMgr},function(t){v=t.ItemMgr},function(t){f=t.SceneMgr}],execute:function(){var S;r._RF.push({},"435146EAlxHWr0n56mHp8Zn","StageDetails",void 0);var C=s.ccclass;s.property,t("StageDetails",C("StageDetails")(S=function(t){function r(){for(var e,r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return e=t.call.apply(t,[this].concat(s))||this,n(i(e),"stage_name",null),n(i(e),"description",null),n(i(e),"goal",[]),n(i(e),"reward_item_root",null),n(i(e),"reward_items",[]),n(i(e),"start_btn",null),e}e(r,t);var s=r.prototype;return s.onLoad=function(){var t,e;m.listen("change select stage",this.name,this.changeSelect,this),this.stage_name=null===(t=this.node.getChildByPath("StageName/Label"))||void 0===t?void 0:t.getComponent(o),this.description=null===(e=this.node.getChildByPath("Description/view/content"))||void 0===e?void 0:e.getComponent(o);for(var n=1;n<=3;n++){var i,r=null===(i=this.node.getChildByPath("Goal/Lbl_Root/Goal_"+n.toString()))||void 0===i?void 0:i.getComponent(o);r&&this.goal.push(r)}this.reward_item_root=this.node.getChildByPath("Reward/Items/view/content"),this.start_btn=this.node.getChildByName("Start_Btn")},s.changeSelect=function(t){var e=t.curr_stage,n=_.getInstance().getStageConf(e).stage[t.idx];this.stage_name&&(this.stage_name.string=n.name),this.description&&(this.description.string=n.description);var i=_.getInstance().getStageGoal(e,t.idx);if(this.goal.length>=i.length)for(var r=0;r<this.goal.length;r++)r<i.length&&(this.goal[r].string=i[r]);var s=d.getInstance();this.setItemList(n.items,s),this.start_btn&&this.start_btn.on("click",(function(){f.getInstance().loadScene("BattleField",t)}))},s.setItemList=function(t,e){for(var n,i,r=v.getInstance(),s=0;s<t.length;s++)if(this.reward_item_root){var o=null;this.reward_items.length<=s?(o=e.generator(this.reward_item_root,"ItemPortrait"))&&this.reward_items.push(o):o=this.reward_items[s],o&&this.initItem(t[s],o,s,r)}for(;this.reward_items.length>t.length;){var g;null===(g=this.reward_items.pop())||void 0===g||g.destroy()}null===(n=this.reward_item_root)||void 0===n||null===(i=n.getComponent(a))||void 0===i||i.setContentSize(new l(150*t.length,150))},s.initItem=function(t,e,n,i){var r,s=e.getComponent(g),a=i.getItemConf(t.id).texture_path;a&&u.loadDir("Texture",a,h,(function(t){s&&(s.spriteFrame=t[0])}),this.name,this.setItemList.name);var l=null===(r=e.getChildByName("Num"))||void 0===r?void 0:r.getComponent(o);l&&t.max>1&&(t.max==t.min?l.string=p.numToChar(t.max):l.string="约"+p.numToChar(Math.floor((t.max+t.min)/2))),e.setPosition(125*n+75,0,0)},r}(c))||S);r._RF.pop()}}}));

System.register("chunks:///_virtual/TouchScreen.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Subscribe.ts"],(function(t){"use strict";var e,n,o,i,c,r,a,s,u,h,l,f,m;return{setters:[function(t){e=t.inheritsLoose,n=t.defineProperty,o=t.assertThisInitialized},function(t){i=t.cclegacy,c=t._decorator,r=t.geometry,a=t.find,s=t.Camera,u=t.systemEvent,h=t.SystemEventType,l=t.PhysicsSystem,f=t.Component},function(t){m=t.Subscribe}],execute:function(){var y;i._RF.push({},"4841dJezXhODb81MKctRBiZ","TouchScreen",void 0);var g=c.ccclass,p=(c.property,r.Ray);t("TouchScreen",g("TouchScreen")(y=function(t){function i(){for(var e,i=arguments.length,c=new Array(i),r=0;r<i;r++)c[r]=arguments[r];return e=t.call.apply(t,[this].concat(c))||this,n(o(e),"touchRay",new p),n(o(e),"mainCamera",null),n(o(e),"touch_flag",""),e}e(i,t);var c=i.prototype;return c.onLoad=function(){var t=this;m.listen("change scene",this.name,(function(e){var n=a("Main Camera");n?t.mainCamera=n.getComponent(s):(t.mainCamera=null,console.log(""))})),u.on(h.TOUCH_START,(function(e,n){t.touch(e,n,"start")}),this),u.on(h.TOUCH_MOVE,(function(e,n){t.touch(e,n,"move")}),this),u.on(h.TOUCH_END,(function(e,n){t.touch(e,n,"end")}),this),u.on(h.TOUCH_CANCEL,(function(e,n){t.touch(e,n,"end")}),this)},c.touch=function(t,e,n){if(this.mainCamera){if(this.mainCamera.screenPointToRay(e.getLocationX(),e.getLocationY(),this.touchRay),l.instance.raycast(this.touchRay)){var o=l.instance.raycastResults;if(o.length<=0)return;var i=o[0].collider.node.uuid;m.trigger("t_"+n+i,t,e)}}else m.trigger("t_"+n+"_2d",t,e)},i}(f))||y);i._RF.pop()}}}));

System.register("chunks:///_virtual/Configure.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Err.ts","./Subscribe.ts","./ResMgr.ts"],(function(e){"use strict";var t,n,i,o,r,s,a,u,c,g;return{setters:[function(e){t=e.defineProperty,n=e.inheritsLoose},function(e){i=e.cclegacy,o=e._decorator,r=e.game,s=e.JsonAsset,a=e.Component},function(e){u=e.Err},function(e){c=e.Subscribe},function(e){g=e.ResMgr}],execute:function(){var d,l,f;i._RF.push({},"4a7543wNyVI2KuDxEpnWG4G","Configure",void 0);var p=o.ccclass;o.property,e("Configure",p("Configure")((f=l=function(e){function t(){return e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){c.listen("resources loaded",this.name,t.init,this),r.addPersistRootNode(this.node)},t.init=function(){g.loadDir("resources","/config",s,(function(e){!e||e.length<1?u.alert("未知错误，配置未能成功加载！",t.name,t.init.name):(e.forEach((function(e){t.setting_dict.set(e.name,e.json)})),t.loaded=!0,c.trigger("settings loaded"))}),t.name,t.init.name)},t.getConfigure=function(e){return t.loaded?t.setting_dict.size<1?(u.alert("Configure: '"+e+"' have not been loaded yet!",t.name,t.getConfigure.name),null):t.setting_dict.get(e)?t.setting_dict.get(e):(u.alert("Configure don't have this part: "+e+".",t.name,t.getConfigure.name),null):(u.alert("Settings: '"+e+"' have not been loaded yet!",t.name,t.getConfigure.name),null)},t}(a),t(l,"setting_dict",new Map),t(l,"loaded",!1),d=f))||d);i._RF.pop()}}}));

System.register("chunks:///_virtual/BattleScene.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Err.ts","./Subscribe.ts","./ResMgr.ts","./Generator.ts","./Functions.ts","./StageMgr.ts","./ItemMgr.ts","./SceneMgr.ts"],(function(t){"use strict";var e,n,i,a,s,o,r,l,u,c,d,h,g,_,v,f,p,m;return{setters:[function(t){e=t.inheritsLoose,n=t.defineProperty,i=t.assertThisInitialized},function(t){a=t.cclegacy,s=t._decorator,o=t.UITransform,r=t.Label,l=t.Sprite,u=t.SpriteFrame,c=t.Component},function(t){d=t.Err},function(t){h=t.Subscribe},function(t){g=t.ResMgr},function(t){_=t.Generator},function(t){v=t.Functions},function(t){f=t.StageMgr},function(t){p=t.ItemMgr},function(t){m=t.SceneMgr}],execute:function(){var b;a._RF.push({},"54e71vfKQ1IIbuA3T8+rFtL","BattleScene",void 0);var w=s.ccclass;s.property,t("BattleMgr",w("BattleMgr")(b=function(t){function a(){for(var e,a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return e=t.call.apply(t,[this].concat(s))||this,n(i(e),"pause_btn",null),n(i(e),"pause_window",null),n(i(e),"curr_stage",""),n(i(e),"result_node",null),n(i(e),"victory",null),n(i(e),"defeat",null),n(i(e),"abandon",null),n(i(e),"return_btn",null),n(i(e),"agian_btn",null),n(i(e),"goals_root",null),n(i(e),"reward_root",null),n(i(e),"stage_data",null),e}e(a,t);var s=a.prototype;return s.onLoad=function(){var t=this;h.listen("change scene",this.name,(function(e,n){"BattleField"===e&&(t.curr_stage=n.curr_stage,h.trigger("prepare battle",n)),t.stage_data=n})),h.listen("battle decided",this.name,this.battle_over,this),h.listen("battle interrupted",this.name,this.battle_over,this),this.pause_btn=this.node.getChildByPath("Battle/Pause"),this.pause_window=this.node.getChildByName("PauseMenu"),this.pause_window&&(this.pause_window.active=!1),this.result_node=this.node.getChildByName("Result"),this.result_node&&(this.victory=this.result_node.getChildByName("Victory"),this.defeat=this.result_node.getChildByName("Defeat"),this.abandon=this.result_node.getChildByName("Abandon"),this.return_btn=this.result_node.getChildByPath("Btns/Return_btn"),this.agian_btn=this.result_node.getChildByPath("Btns/Again_btn"),this.goals_root=this.result_node.getChildByPath("Victory/Goals/view/content"),this.reward_root=this.result_node.getChildByPath("Victory/Rewards/view/content"),this.result_node.active=!1)},s.start=function(){var t=this;if(this.pause_btn&&this.pause_window){this.pause_btn.on("click",(function(){h.trigger("pause"),t.pause_window&&(t.pause_window.active=!0)}));var e=this.pause_window.getChildByName("Confirm"),n=this.pause_window.getChildByName("Resume");e&&n&&(e.on("click",(function(){t.pause_window&&(t.pause_window.active=!1),h.trigger("resume"),h.trigger("battle interrupted",!0,!1,[])})),n.on("click",(function(){t.pause_window&&(t.pause_window.active=!1),h.trigger("resume")})))}this.return_btn&&this.return_btn.on("click",(function(){m.getInstance().loadScene("Expedition",t.curr_stage)})),this.agian_btn&&this.agian_btn.on("click",this.battle_again,this)},s.battle_again=function(){m.getInstance().loadScene("BattleField",this.stage_data)},s.battle_over=function(t,e,n){if(this.result_node&&this.defeat&&this.victory&&this.abandon)if(this.result_node.active=!0,this.abandon.active=this.victory.active=this.defeat.active=!1,t)this.abandon.active=!0;else if(e){this.victory.active=!0;var i=this.stage_data.curr_stage,a=f.getInstance().getStageConf(i).stage[this.stage_data.idx],s=_.getInstance();this.setGoalNode(s,i,n),this.setRewardsNode(s,a.items)}else this.defeat.active=!0;else d.console("Result node can't be null!",this.name,this.battle_over.name)},s.setGoalNode=function(t,e,n){var i,a=f.getInstance().getStageGoal(e,this.stage_data.idx),s=null===(i=this.goals_root)||void 0===i?void 0:i.getComponent(o);s&&s.setContentSize(s.contentSize.width,100*a.length);for(var l=0;l<a.length&&l<n.length;l++)if(this.goals_root){var u=t.generator(this.goals_root,"Stage_Goal");if(u){var c=u.getComponent(r);c&&(c.string=a[l]);var d=u.getChildByName("Point_Disable"),h=u.getChildByName("Point_Enable");if(d&&h){var g=[!n[l],n[l]];d.active=g[0],h.active=g[1]}var _=u.getPosition();u.setPosition(_.x,-100*l-50,0)}}},s.setRewardsNode=function(t,e){var n=this,i=p.getInstance(),a=0;e.forEach((function(e){if(n.reward_root){var s;if(e.p<1)if(!v.probToVal([e.p,1-e.p],[!0,!1]))return;var o=t.generator(n.reward_root,"ItemPortrait"),c=null==o?void 0:o.getComponent(l),d=i.getItemConf(e.id).texture_path;d&&g.loadDir("Texture",d,u,(function(t){c&&(c.spriteFrame=t[0])}),n.name,n.setRewardsNode.name);var _=null==o||null===(s=o.getChildByName("Num"))||void 0===s?void 0:s.getComponent(r),f=0;_&&(e.max>1?(f=e.max==e.min?e.max:v.randomInSec(e.max,e.min),_.string+=v.numToChar(f)):f=1,h.trigger("get item",e.id,f));var p=125*a+75;null==o||o.setPosition(p,0,0),a++}}))},a}(c))||b);a._RF.pop()}}}));

System.register("chunks:///_virtual/HerosMgr.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Subscribe.ts","./Configure.ts"],(function(e){"use strict";var a,i,t,l,r,n,f,s;return{setters:[function(e){a=e.defineProperty,i=e.inheritsLoose,t=e.assertThisInitialized},function(e){l=e.cclegacy,r=e._decorator,n=e.Component},function(e){f=e.Subscribe},function(e){s=e.Configure}],execute:function(){var o,_,u;l._RF.push({},"5557eVQmD9AFo1owxXHT1Xu","HerosMgr",void 0);var d=r.ccclass;r.property,e("HerosMgr",d("HerosMgr")((u=_=function(e){function l(i){var l;l=e.call(this,i)||this,a(t(l),"common",void 0),a(t(l),"hero_conf",new Map),a(t(l),"troop",{heros:[{id:"CaoCao_ally",name:"曹操",hero_id:"CaoCao",prefab:"General",level:60,hp:1800,atk:6e3,def:80,atkEff:"default_atk_particle",hitEff:"default_hit_particle",skill_name:"default",skillEff:"default_skill_particle",arms:"Cavalry_Lv1",is_sp:!1,is_select:!0,idx:0},{id:"LiuBei_ally",name:"刘备",hero_id:"LiuBei",prefab:"General",level:60,hp:1200,atk:8e3,def:50,atkEff:"default_atk_particle",hitEff:"default_hit_particle",skill_name:"default",skillEff:"default_skill_particle",arms:"Archer_Lv1",is_sp:!1,is_select:!0,idx:1},{id:"SunQuan_ally",name:"孙权",hero_id:"SunQuan",prefab:"General",level:60,hp:2400,atk:5500,def:100,atkEff:"default_atk_particle",hitEff:"default_hit_particle",skill_name:"default",skillEff:"default_skill_particle",arms:"Infantry_Lv1",is_sp:!1,is_select:!0,idx:2},{id:"LvBu_ally",hero_id:"LvBu",name:"吕布",prefab:"General",level:60,hp:2800,atk:5500,def:100,atkEff:"default_atk_particle",hitEff:"default_hit_particle",skill_name:"default",skillEff:"default_skill_particle",arms:"Infantry_Lv1",is_sp:!0,is_select:!0,idx:3},{id:"ZhugeLiang_ally",name:"诸葛亮",hero_id:"ZhugeLiang",prefab:"General",level:60,hp:1500,atk:7e3,def:80,atkEff:"default_atk_particle",hitEff:"default_hit_particle",skill_name:"default",skillEff:"default_skill_particle",arms:"Cavalry_Lv1",is_sp:!1,is_select:!0,idx:4},{id:"ZhouYu_ally",name:"周瑜",hero_id:"ZhouYu",prefab:"General",level:60,hp:1500,atk:7e3,def:80,atkEff:"default_atk_particle",hitEff:"default_hit_particle",skill_name:"default",skillEff:"default_skill_particle",arms:"Cavalry_Lv1",is_sp:!1,is_select:!1,idx:5}],formation:{id:"snake",name:"长蛇阵",pos_idxs:[0,1,4,5,8],introduce:"增加部队普通攻击能力",ids_idxs:[{id:"CaoCao_ally",idx:0},{id:"LiuBei_ally",idx:1},{id:"SunQuan_ally",idx:2},{id:"LvBu_ally",idx:3},{id:"ZhugeLiang_ally",idx:4}]}});var r=s.getConfigure("hero");l.common=r.common;for(var n=0;n<r.hero.length;n++)l.hero_conf.set(r.hero[n].id,r.hero[n]);return f.listen("update troop",l.name,(function(e){l.troop=e})),l}i(l,e),l.getInstance=function(){return l.instance||(l.instance=new l("HerosMgr")),l.instance};var r=l.prototype;return r.getTroops=function(){return this.troop},r.getHeroConf=function(e){return this.hero_conf.has(e)?this.hero_conf.get(e):null},r.getConfigureConf=function(e){return this.common[e]},l}(n),a(_,"instance",void 0),o=u))||o);l._RF.pop()}}}));

System.register("chunks:///_virtual/Test.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var e,n,o,c;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,o=t._decorator,c=t.Component}],execute:function(){var r;n._RF.push({},"58ccf0dcLZB/IWpk0IfiK3I","Test",void 0);var s=o.ccclass;o.property,t("Test",s("Test")(r=function(t){function n(){return t.apply(this,arguments)||this}return e(n,t),n.prototype.onLoad=function(){},n}(c))||r);n._RF.pop()}}}));

System.register("chunks:///_virtual/Err.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(r){"use strict";var t,o,n,e;return{setters:[function(r){t=r.defineProperty},function(r){o=r.cclegacy,n=r._decorator,e=r.game}],execute:function(){var c,u,i;o._RF.push({},"620e1qmxXFJFZjtu82dIEUg","Err",void 0);var s=n.ccclass;n.property,r("Err",s("Err")((i=u=function(){function r(){}return r.console=function(r){function t(t,o,n){return r.apply(this,arguments)}return t.toString=function(){return r.toString()},t}((function(r,t,o){console.error("Error: "+r+"\t at "+t+"."+o)})),r.alert=function(t,o,n){console.error("Error: "+t+"\t at "+o+"."+n),r.stopGame()},r.print=function(t,o,n){console.error("Error: "+t+"\t at "+o+"."+n),r.stopGame()},r.stopGame=function(){e.pause()},r}(),t(u,"error",void 0),c=i))||c);o._RF.pop()}}}));

System.register("chunks:///_virtual/StartScene.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Err.ts","./Subscribe.ts","./Configure.ts","./ResMgr.ts","./MoveCamera.ts"],(function(t){"use strict";var n,e,i,o,s,r,a,l,g,c,h,u,p,_,d;return{setters:[function(t){n=t.inheritsLoose,e=t.defineProperty,i=t.assertThisInitialized},function(t){o=t.cclegacy,s=t._decorator,r=t.Sprite,a=t.Font,l=t.SpriteFrame,g=t.Label,c=t.Component},function(t){h=t.Err},function(t){u=t.Subscribe},function(t){p=t.Configure},function(t){_=t.ResMgr},function(t){d=t.MoveCamera}],execute:function(){var f;o._RF.push({},"66392uVKzNLs4yndOLi/Uwh","StartScene",void 0);var m=s.ccclass;s.property,t("StartScene",m("StartScene")(f=function(t){function o(){for(var n,o=arguments.length,s=new Array(o),r=0;r<o;r++)s[r]=arguments[r];return n=t.call.apply(t,[this].concat(s))||this,e(i(n),"bg",null),e(i(n),"start_btn_sp",null),e(i(n),"font",null),e(i(n),"login_bg",null),e(i(n),"login_btn_sp",null),e(i(n),"regist_btn_sp",null),e(i(n),"conf",null),e(i(n),"sprite_map",new Map),n}n(o,t);var s=o.prototype;return s.onLoad=function(){var t,n,e,i,o,s=this;u.listen("bundle loaded",this.name,this.init,this),u.listen("settings loaded",this.name,(function(){s.conf=p.getConfigure("start_scene")})),this.bg=null===(t=this.node.getChildByName("BackGround"))||void 0===t?void 0:t.getComponent(r),this.start_btn_sp=null===(n=this.node.getChildByName("StartBtn"))||void 0===n?void 0:n.getComponent(r);var a=this.node.getChildByName("Login_window");this.login_bg=null==a||null===(e=a.getChildByName("Bg"))||void 0===e?void 0:e.getComponent(r),this.login_btn_sp=null==a||null===(i=a.getChildByName("Login"))||void 0===i?void 0:i.getComponent(r),this.regist_btn_sp=null==a||null===(o=a.getChildByName("Regist"))||void 0===o?void 0:o.getComponent(r),this.bg&&this.start_btn_sp&&this.login_bg&&this.login_btn_sp&&this.regist_btn_sp?this.sprite_map=new Map([["bg",this.bg],["start_btn_sp",this.start_btn_sp],["login_bg",this.login_bg],["login_btn_sp",this.login_btn_sp],["regist_btn_sp",this.regist_btn_sp]]):h.console("Component hasn't loaded yet!",this.name,this.init.name)},s.init=function(){var t=this;_.loadRes("Texture",this.conf.font,a,(function(n){t.font=n,t.setFont()}),this.name,this.init.name),this.conf.sprites.forEach((function(n){var e=t.sprite_map.get(n.id);e?t.getSpriteFrame(n.path,e):h.console("Please check conf!",t.name,t.init.name)})),d.getInstance()},s.getSpriteFrame=function(t,n){_.loadDir("Texture",t,l,(function(t){n.spriteFrame=t[0]}),this.name,this.getSpriteFrame.name)},s.setFont=function(){for(var t=this.node.children;t.length>0;){var n=t.pop();if(!n)break;t=n.children.concat(t);var e=n.getComponent(g);e&&(e.font=this.font)}u.trigger("StartScene loaded")},o}(c))||f);o._RF.pop()}}}));

System.register("chunks:///_virtual/Json2Exc.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(n){"use strict";var t,o,c,r;return{setters:[function(n){t=n.inheritsLoose},function(n){o=n.cclegacy,c=n._decorator,r=n.Component}],execute:function(){var e;o._RF.push({},"689c3Zy24xCJ6+TrfKRd6I7","Json2Exc",void 0);var s=c.ccclass;c.property,n("Json2Exc",s("Json2Exc")(e=function(n){function o(){return n.apply(this,arguments)||this}t(o,n);var c=o.prototype;return c.J2E=function(n){},c.E2J=function(n){},o}(r))||e);o._RF.pop()}}}));

System.register("chunks:///_virtual/StagePoint.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Subscribe.ts","./ResMgr.ts","./Generator.ts","./Functions.ts","./StageMgr.ts","./MonsterMgr.ts"],(function(t){"use strict";var e,n,i,s,a,o,r,l,u,c,h,d,g,m,_,f,v,p,b;return{setters:[function(t){e=t.inheritsLoose,n=t.defineProperty,i=t.assertThisInitialized},function(t){s=t.cclegacy,a=t._decorator,o=t.MeshRenderer,r=t.Material,l=t.find,u=t.Camera,c=t.v3,h=t.Label,d=t.tween,g=t.Component},function(t){m=t.Subscribe},function(t){_=t.ResMgr},function(t){f=t.Generator},function(t){v=t.Functions},function(t){p=t.StageMgr},function(t){b=t.MonsterMgr}],execute:function(){var S;s._RF.push({},"6f65ezBaVdDXrmJwFxDWTmB","StagePoint",void 0);var M=a.ccclass;a.property,t("StagePoint",M("StagePoint")(S=function(t){function s(){for(var e,s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a))||this,n(i(e),"ui_target",null),n(i(e),"ui_node",null),n(i(e),"text",null),n(i(e),"camera",null),n(i(e),"meshR",null),n(i(e),"enable_mtr",null),n(i(e),"disable_mtr",null),n(i(e),"select_mtr",null),n(i(e),"isEnabled",!1),n(i(e),"slt_flag",!1),n(i(e),"data",null),n(i(e),"idx",0),e}e(s,t);var a=s.prototype;return a.onLoad=function(){var t=this;this.meshR=this.node.getComponent(o),_.loadRes("Material","/Stage/Stage_enable",r,(function(e){var n;(t.enable_mtr=e,t.isEnabled)&&(null===(n=t.meshR)||void 0===n||n.setMaterial(t.enable_mtr,0))}),this.name,this.onLoad.name),_.loadRes("Material","/Stage/Stage_disable",r,(function(e){t.disable_mtr=e}),this.name,this.onLoad.name),_.loadRes("Material","/Stage/Stage_selected",r,(function(e){t.select_mtr=e}),this.name,this.onLoad.name),m.listen("touch_start"+this.node.uuid,this.node.uuid,(function(){var e;t.isEnabled&&(t.slt_flag=!0,null===(e=t.meshR)||void 0===e||e.setMaterial(t.select_mtr,0))})),m.listen("touch_end"+this.node.uuid,this.node.uuid,(function(){t.isEnabled&&t.slt_flag&&t.changeSelect()})),m.listen("touch_end",this.node.uuid,(function(){var e;t.isEnabled&&t.slt_flag&&(t.slt_flag=!1,null===(e=t.meshR)||void 0===e||e.setMaterial(t.enable_mtr,0))}))},a.init=function(t,e,n){var i;this.ui_target=this.node.getChildByName("UITarget"),this.camera=null===(i=l("/Main Camera"))||void 0===i?void 0:i.getComponent(u);var s=c(e.pos[0],e.pos[1],e.pos[2]);this.node.setPosition(s);var a=f.getInstance();if(this.ui_node=a.generator(t,"Stage_UI"),this.ui_target&&this.ui_node){this.ui_node.on("click",this.changeSelect,this);var o=this.ui_node.getChildByName("Label");o&&(this.text=o.getComponent(h)),this.text&&(this.text.string=e.name);var r=b.getInstance(),d=[];e.monsters.forEach((function(t){d.push(r.getMonsterAttr(t))})),this.idx=e.idx;for(var g=[],m=0;m<d.length;m++)g.push({id:d[m].id,idx:m});this.data={curr_stage:p.getInstance().curr_stage,idx:this.idx,formation:{id:"monster",name:"怪物",ids_idxs:g,pos_idxs:[0,1,2,3,4,5,6,7,8]},heros:d},this.idx<=n&&(this.isEnabled=!0,this.idx===n&&this.changeSelect())}},a.changeSelect=function(){var t=this,e=this.node.getPosition().x+10;if(this.camera){var n=this.camera.node.getPosition(),i=d(this.camera.node).to(1,{position:c(e,n.y,n.z)},{easing:"sineInOut"}).call((function(){m.remove("touch screen start",t.name)})).start();m.listen("touch screen start",this.name,(function(){i.stop(),m.remove("touch screen start",t.name)}),this)}m.trigger("change select stage",this.data)},a.update=function(){this.ui_target&&this.camera&&this.ui_node&&v.UIFllow3DNode(this.ui_node,this.camera,this.ui_target)},s}(g))||S);s._RF.pop()}}}));

System.register("chunks:///_virtual/NetWork.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Err.ts"],(function(e){"use strict";var t,n,o,s,r,i,c;return{setters:[function(e){t=e.inheritsLoose,n=e.defineProperty,o=e.assertThisInitialized},function(e){s=e.cclegacy,r=e._decorator,i=e.Component},function(e){c=e.Err}],execute:function(){var a;s._RF.push({},"71db522BotC/5rA/qLKKGjj","NetWork",void 0);var l=r.ccclass;r.property,e("NetWork",l("NetWork")(a=function(e){function s(){for(var t,s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return t=e.call.apply(e,[this].concat(r))||this,n(o(t),"ws",new WebSocket("ws://82.157.123.54:9010/ajaxchattest")),n(o(t),"nodeDict",new Map),t}t(s,e);var r=s.prototype;return r.onLoad=function(){var e=this;this.ws.onopen=function(e){console.log(e+"\nSend Text WS was opened.")},this.ws.onmessage=function(e){console.log("Response text msg: "+e.data),console.log("Response msg type: "+typeof e.data)},this.ws.onerror=function(e){console.log("Send Text fired an error")},this.ws.onclose=function(e){console.log("WebSocket instance closed.")},this.scheduleOnce((function(){e.ws.readyState===WebSocket.OPEN?e.ws.send("User connect success"):console.log("WebSocket instance wasn't ready...")}),1)},r.sendMsg=function(e){this.ws.send(e)},r.sendFile=function(e){this.ws.send(e)},r.receiveMsg=function(e){var t=e.split(";");if(t.length<1)c.alert("Message should not be null.",this.name,this.receiveMsg.name);else if(1===t.length&&console.log(e),t.length>1){var n=this.nodeDict.get(t[0]);if(!n)return void c.alert("Node not found.",this.name,this.receiveMsg.name);var o=t.shift();n.emit("receiveMsg",o,t)}},s}(i))||a);s._RF.pop()}}}));

System.register("chunks:///_virtual/AtkMgr.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Subscribe.ts","./Functions.ts","./HpMgr.ts","./DmgCal.ts"],(function(e){"use strict";var t,i,n,l,s,a,r,c,o,u;return{setters:[function(e){t=e.inheritsLoose,i=e.defineProperty,n=e.assertThisInitialized},function(e){l=e.cclegacy,s=e._decorator,a=e.Component},function(e){r=e.Subscribe},function(e){c=e.Functions},function(e){o=e.HpMgr},function(e){u=e.DmgCal}],execute:function(){var h;l._RF.push({},"72b74mZotFPL7EUJB7rOzxg","AtkMgr",void 0);var d=s.ccclass;s.property,e("AtkMgr",d("AtkMgr")(h=function(e){function l(){for(var t,l=arguments.length,s=new Array(l),a=0;a<l;a++)s[a]=arguments[a];return t=e.call.apply(e,[this].concat(s))||this,i(n(t),"allies",[]),i(n(t),"enemies",[]),i(n(t),"all",[]),t}t(l,e);var s=l.prototype;return s.onLoad=function(){var e=this;r.listen("battle is ready",this.name,this.start_battle,this),r.listen("hero die",this.name,(function(t){t.camp===e.allies[0].camp?c.del(e.allies,t):c.del(e.enemies,t),c.del(e.all,t),t.node.destroy()})),r.listen("battle interrupted",this.name,(function(){r.remove("hero die",e.name),e.unscheduleAllCallbacks()}))},s.start_battle=function(e,t){var i=this;this.allies=e,this.enemies=t,this.all=c.alternate(this.allies,this.enemies);var n=-1;this.schedule((function(){if(i.allies.length<1||i.enemies.length<1)return i.unscheduleAllCallbacks(),void r.trigger("battle decided",!1,i.allies.length>i.enemies.length,[!0,!0,!0]);n=(n+1)%i.all.length,i.attack(i.all[n])}),1.5)},s.attack=function(e){var t,i,n=o.getInstance();t=e.camp===this.allies[0].camp?this.enemies[0]:this.allies[0];var l=u.calculate(e,t);n.changeHp(t.id,-l);var s=e.atkEff;i=t.hitEff,s&&i&&(s.play(),i.play())},l}(a))||h);l._RF.pop()}}}));

System.register("chunks:///_virtual/Info.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Err.ts"],(function(t){"use strict";var n,i,e,o,f,r,c,s,_;return{setters:[function(t){n=t.inheritsLoose,i=t.defineProperty,e=t.assertThisInitialized,o=t.createClass},function(t){f=t.cclegacy,r=t._decorator,c=t.ParticleSystem,s=t.Component},function(t){_=t.Err}],execute:function(){var a;f._RF.push({},"763eddn/1pE1KZHknjLgf+7","Info",void 0);var h=r.ccclass;r.property,t("Info",h("Info")(a=function(t){function f(){for(var n,o=arguments.length,f=new Array(o),r=0;r<o;r++)f[r]=arguments[r];return n=t.call.apply(t,[this].concat(f))||this,i(e(n),"__id",""),i(e(n),"__atkEff",void 0),i(e(n),"__hitEff",void 0),i(e(n),"__camp",""),i(e(n),"__conf",void 0),n}n(f,t);var r=f.prototype;return r.onLoad=function(){},r.init=function(t,n,i){var e,o;this.__id=t,this.__camp=n,this.__conf=i;var f=this.__conf.atkEff;this.__atkEff=null===(e=this.node.getChildByName(f))||void 0===e?void 0:e.getComponent(c);var r=this.__conf.hitEff;this.__hitEff=null===(o=this.node.getChildByName(r))||void 0===o?void 0:o.getComponent(c),this.__atkEff||_.console("Can't find child or component!",this.name,this.init.name)},r.getConf=function(t){return this.__conf[t]},o(f,[{key:"id",get:function(){return this.__id}},{key:"atkEff",get:function(){return this.__atkEff}},{key:"hitEff",get:function(){return this.__hitEff}},{key:"camp",get:function(){return this.__camp}}]),f}(s))||a);f._RF.pop()}}}));

System.register("chunks:///_virtual/StageMaker.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Err.ts","./Subscribe.ts","./Generator.ts","./StageMgr.ts","./StagePoint.ts"],(function(t){"use strict";var e,n,r,a,o,i,s,c,g,u,f,l;return{setters:[function(t){e=t.inheritsLoose,n=t.defineProperty,r=t.assertThisInitialized},function(t){a=t.cclegacy,o=t._decorator,i=t.find,s=t.Component},function(t){c=t.Err},function(t){g=t.Subscribe},function(t){u=t.Generator},function(t){f=t.StageMgr},function(t){l=t.StagePoint}],execute:function(){var p;a._RF.push({},"765bc3YG/hPY7uK+YRxg9bF","StageMaker",void 0);var h=o.ccclass;o.property,t("StageMaker",h("StageMaker")(p=function(t){function a(){for(var e,a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o))||this,n(r(e),"mgr",null),n(r(e),"conf",void 0),n(r(e),"test_data",{main:2}),e}e(a,t);var o=a.prototype;return o.onLoad=function(){g.listen("prepare stage",this.name,this.prepare,this)},o.prepare=function(t){var e,n=this;this.mgr=f.getInstance(),this.mgr.curr_stage=t;var r=i("/SafeArea/Stage_Root"),a=i("/Canvas/StageUI_Root"),o=u.getInstance(),s=this.getRecord(t);this.conf=null===(e=this.mgr)||void 0===e?void 0:e.getStageConf(t),this.conf.stage.forEach((function(t){if(r&&a){var e=o.generator(r,"Stage_model"),i=null==e?void 0:e.getComponent(l);i&&i.init(a,t,s)}else c.console("Can'f find root!",n.name,n.prepare.name)}))},o.getRecord=function(t){return this.test_data[t]},a}(s))||p);a._RF.pop()}}}));

System.register("chunks:///_virtual/StageScene.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Subscribe.ts","./SceneMgr.ts"],(function(n){"use strict";var t,e,o,i,r,a,c,s;return{setters:[function(n){t=n.inheritsLoose,e=n.defineProperty,o=n.assertThisInitialized},function(n){i=n.cclegacy,r=n._decorator,a=n.Component},function(n){c=n.Subscribe},function(n){s=n.SceneMgr}],execute:function(){var u;i._RF.push({},"80ed3LIGndKWYTai4xgjojl","StageScene",void 0);var l=r.ccclass;r.property,n("StageScene",l("StageScene")(u=function(n){function i(){for(var t,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return t=n.call.apply(n,[this].concat(r))||this,e(o(t),"stage_name",""),e(o(t),"formation_btn",null),e(o(t),"formation_node",null),e(o(t),"retrun_btn",null),t}return t(i,n),i.prototype.onLoad=function(){var n,t=this;this.retrun_btn=this.node.getChildByPath("TopBar/Return"),null===(n=this.retrun_btn)||void 0===n||n.on("click",(function(){s.getInstance().loadScene("Main",null)})),this.formation_btn=this.node.getChildByPath("Btns/Formation_Btn"),this.formation_node=this.node.getChildByPath("Windows_Root/Formation"),this.formation_btn&&this.formation_btn.on("click",(function(){t.formation_node&&(t.formation_node.active=!0)})),c.listen("change scene",this.name,(function(n,e){"Expedition"===n&&(t.stage_name=e,c.trigger("prepare stage",t.stage_name))}))},i}(a))||u);i._RF.pop()}}}));

System.register("chunks:///_virtual/Functions.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var n,r,e,o,a,i,u,c,l,f;return{setters:[function(t){n=t.defineProperty,r=t.inheritsLoose},function(t){e=t.cclegacy,o=t._decorator,a=t.Vec3,i=t.v4,u=t.v3,c=t.math,l=t.Quat,f=t.Component}],execute:function(){var h,s,y;e._RF.push({},"8af06peD1xBwpJNBlnbogCJ","Functions",void 0);var g=o.ccclass,p=(o.property,Math.sin),v=Math.cos,x=Math.pow;t("Functions",g("Functions")((y=s=function(t){function n(){return t.apply(this,arguments)||this}return r(n,t),n.numToStr=function(t){if(0===t)return"0";for(var n="",r=t;r>0;)r%=1e3,n=t>=1e3&&r<100?r<10?"00"+r.toString()+","+n:"0"+r.toString()+","+n:r.toString()+","+n,r=t=Math.floor(t/1e3);return n=n.substr(0,n.length-1)},n.numToChar=function(t){for(var r=0;t>=1e3;r++)t=Math.floor(t/1e3);var e=n.char_map.get(r);return e?t.toString().concat(e):(t*=Math.pow(1e3,r)).toString()},n.alternate=function(t,n){for(var r=[],e=t.length>n.length?n:t,o=t.length>n.length?t:n,a=0;a<o.length;a++)r.push(o[a]),a<e.length&&r.push(e[a]);return r},n.del=function(t,n){var r=t.indexOf(n);r>-1&&t.splice(r,1)},n.UIFllow3DNode=function(t,n,r){var e=t.parent;if(e){var o=new a;n.convertToUINode(r.worldPosition,e,o),t.setPosition(o)}},n.deepCopy=function(t){var n={};for(var r in t)n[r]=JSON.parse(JSON.stringify(t[r]));return n},n.getNodeByName=function(t,n){var r=n.getChildByName(t);if(r)return r;for(var e=n.children;e.length>0&&!(r=e[0].getChildByName(t));)(e=e.concat(e[0].children)).splice(0,1);return r||null},n.getNodeByPath=function(t,n){for(var r=t.split("/"),e=n;r.length>0&&e;)e=e.getChildByName(r[0]),r.splice(0,1);return e||null},n.sumOfArray=function(t){var n=0;return t.forEach((function(t){n+=t})),n},n.probToVal=function(t,r){if(r.length<1)return null;if(t.length<1||t.length!=r.length)return r[0];for(var e=n.sumOfArray(t),o=[],a=0;a<t.length;a++)o[a]=0,a>0&&(o[a]=o[a-1]),o[a]+=t[a];for(var i=Math.random()*e,u=0;u<o.length;u++)if(i<=o[u])return r[u];return r[0]},n.randomInSec=function(t,n){return n+Math.round(Math.random()*(t-n))},n.charAt=function(t,n){return t.length>n?t.charAt(n):-1},n.exch=function(t,n,r){var e=t[n];t[n]=t[r],t[r]=e},n.sortStr=function(t,r,e,o){if(!(e<=r)){for(var a=r,i=e,u=this.charAt(t[r],o),c=r+1;c<=i;){var l=this.charAt(t[c],o);l<u?n.exch(t,a++,c++):l>u?n.exch(t,c,i--):c++}n.sortStr(t,r,a-1,o),-1!=u&&n.sortStr(t,a,i,o+1),n.sortStr(t,i+1,e,o)}},n.EulerToQuaternion=function(t){var n=p(t.y/2)*p(t.z/2)*v(t.x/2)+v(t.y/2)*v(t.z/2)*p(t.x/2),r=p(t.y/2)*v(t.z/2)*v(t.x/2)+v(t.y/2)*p(t.z/2)*p(t.x/2),e=v(t.y/2)*p(t.z/2)*v(t.x/2)-p(t.y/2)*v(t.z/2)*p(t.x/2),o=v(t.y/2)*v(t.z/2)*v(t.x/2)-p(t.y/2)*p(t.z/2)*p(t.x/2);return i(n,r,e,o)},n.Multiply=function(t,n){var r=t.w*n.w-t.x*n.x-t.y*n.y-t.z*n.z,e=t.w*n.x+t.x*n.w+t.y*n.z-t.z*n.y,o=t.w*n.y+t.y*n.w+t.z*n.x-t.x*n.z,a=t.w*n.z+t.z*n.w+t.x*n.y-t.y*n.x;return i(e,o,a,r)},n.ToRadian=function(t){return u(c.toRadian(t.x),c.toRadian(t.y),c.toRadian(t.z))},n.getInverse=function(t){var n=x(t.x,2)+x(t.y,2)+x(t.z,2)+x(t.w,2);return i(-t.x,-t.y,-t.z,t.w).multiplyScalar(1/n)},n.QuaternionRotate=function(t,r){var e=i(t.x,t.y,t.z,0),o=n.EulerToQuaternion(n.ToRadian(r)),a=n.getInverse(o),c=n.Multiply(o,e);return c=n.Multiply(c,a),t=u(c.x,c.y,c.z)},n.getRotateVec=function(t,n){var r=new l(t.x,t.y,t.z,0),e=new l;l.invert(e,n);var o=new l;return l.multiply(o,n,r),l.multiply(o,o,e),t=u(o.x,o.y,o.z)},n}(f),n(s,"char_map",new Map([[0," "],[1,"k"],[2,"M"],[3,"G"],[4,"T"],[5,"P"],[6,"E"],[7,"Z"],[8,"Y"]])),h=y))||h);e._RF.pop()}}}));

System.register("chunks:///_virtual/BasicException.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var i,e,n,s,c,o;return{setters:[function(t){i=t.inheritsLoose,e=t.defineProperty,n=t.assertThisInitialized,s=t.wrapNativeSuper},function(t){c=t.cclegacy,o=t._decorator}],execute:function(){var r;c._RF.push({},"8bd04qyxNxJT5dEY0GnptVy","BasicException",void 0);var a=o.ccclass;o.property,t("BasicExceptionCode",{PARAM_COUNT:"BASIC0001",PARAM_TYPE:"BASIC0002",PARAM_NULL:"BASIC0003"}),t("BasicException",a("BasicException")(r=function(t){function s(i,s,c,o){var r;return void 0===i&&(i="BASIC9999"),void 0===s&&(s=""),void 0===c&&(c=""),void 0===o&&(o=""),r=t.call(this)||this,e(n(r),"map",new Map),e(n(r),"code",""),e(n(r),"msg",""),e(n(r),"detail",""),e(n(r),"script",""),e(n(r),"func",""),r.map=new Map([["BASIC0001","参数数量错误"],["BASIC0002","参数类型错误"],["BASIC0003","参数为空"],["BASIC9999","未知错误"]]),r.check(i,s,c,o),r}i(s,t);var c=s.prototype;return c.appendMap=function(t){this.map=new Map([].concat(this.map,t))},c.check=function(t,i,e,n){void 0===t&&(t="BASIC9999"),void 0===i&&(i=""),void 0===e&&(e="Unknown"),void 0===n&&(n="Unknown"),this.detail=i,this.script=e,this.func=n,this.map.has(t)?(this.code=t,this.msg=this.map.get(t)):(this.code="BASIC9999",this.msg=this.map.get(t))},c.getCode=function(){return this.code},c.getMsg=function(){return this.msg},c.getDetail=function(){return this.detail},c.getErrPos=function(){return this.script+"."+this.func},c.toString=function(){return"Error code:"+this.code+",msg:"+this.msg+",detail:"+this.detail+"\nat: "+this.script+"."+this.func},s}(s(Error)))||r);c._RF.pop()}}}));

System.register("chunks:///_virtual/DmgCal.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Subscribe.ts","./Configure.ts"],(function(t){"use strict";var e,n,r,i,o,a,_;return{setters:[function(t){e=t.defineProperty,n=t.inheritsLoose},function(t){r=t.cclegacy,i=t._decorator,o=t.Component},function(t){a=t.Subscribe},function(t){_=t.Configure}],execute:function(){var c,u,s;r._RF.push({},"ae7b0kAXPZM9qNLD2yuk0Jy","DmgCal",void 0);var m=i.ccclass;i.property,t("DmgCal",m("DmgCal")((s=u=function(t){function e(){return t.apply(this,arguments)||this}return n(e,t),e.prototype.onLoad=function(){a.listen("settings loaded",this.name,e.init,this)},e.init=function(){var t=_.getConfigure("soldier").common;e.max_dmg_ratio=t.max_dmg_ratio,e.min_dmg_ratio=t.min_dmg_ratio,e.base_cri_dmg_rate=t.base_cri_dmg_rate,e.base_blk_dmg_rate=t.base_blk_dmg_rate},e.calculate=function(t,e){return t.getConf("atk")-e.getConf("def")},e.max=function(t,e){return t>e?t:e},e.min=function(t,e){return t>e?e:t},e}(o),e(u,"max_dmg_ratio",0),e(u,"min_dmg_ratio",0),e(u,"base_cri_dmg_rate",0),e(u,"base_blk_dmg_rate",0),e(u,"attr_diff",0),e(u,"counter",0),e(u,"tech_diff",0),c=s))||c);r._RF.pop()}}}));

System.register("chunks:///_virtual/BattleFieldMaker.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Err.ts","./Subscribe.ts","./Generator.ts","./HpMgr.ts","./HerosMgr.ts","./Info.ts"],(function(e){"use strict";var t,n,i,r,s,o,a,l,c,f,u,d,h,p,g;return{setters:[function(e){t=e.inheritsLoose,n=e.defineProperty,i=e.assertThisInitialized},function(e){r=e.cclegacy,s=e._decorator,o=e.find,a=e.Vec3,l=e.v3,c=e.Component},function(e){f=e.Err},function(e){u=e.Subscribe},function(e){d=e.Generator},function(e){h=e.HpMgr},function(e){p=e.HerosMgr},function(e){g=e.Info}],execute:function(){var m;r._RF.push({},"bd906/qyOxFJ4wRnyW1VD37","BattleFieldMaker",void 0);var v=s.ccclass;s.property,e("BattleFieldMaker",v("BattleFieldMaker")(m=function(e){function r(){for(var t,r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return t=e.call.apply(e,[this].concat(s))||this,n(i(t),"allies",[]),n(i(t),"enemies",[]),t}t(r,e);var s=r.prototype;return s.onLoad=function(){u.listen("prepare battle",this.name,this.prepare,this)},s.prepare=function(e){var t=o("/SafeArea/Armies"),n=null==t?void 0:t.getChildByName("Allies"),i=null==t?void 0:t.getChildByName("Enemies");if(n&&i){var r=p.getInstance(),s=d.getInstance(),a=r.getTroops(),l=r.getConfigureConf("prePos");this.genArmies(n,a,s,l,"ally"),this.genArmies(i,e,s,l,"enemy"),u.trigger("battle is ready",this.allies,this.enemies)}else f.print("Can't find armies nodes.",this.name,this.onLoad.name)},s.genArmies=function(e,t,n,i,r){var s=h.getInstance(),o=new Map;t.heros.forEach((function(e){o.set(e.id,e)}));var c=t.formation.ids_idxs,u=t.formation.pos_idxs;if(c.length<=u.length)for(var d=0;d<c.length;d++){var p=o.get(c[d].id),m=u[c[d].idx],v=i.pos[m],y=new a(v[0]*i["3d_dist"],0,v[1]*i["3d_dist"]),_=n.generator(e,"Hero_3D",y);if(!_)return;n.generator(_,p.atkEff,l(0,10,0)),n.generator(_,p.hitEff,l(0,10,0)),n.generator(_,p.arms);var M=_.getComponent(g);if(!M)return void f.console("Can't find component!",this.name,this.genArmies.name);"ally"===r?(M.init(p.id,r,p),this.allies.push(M)):"enemy"===r&&(M.init(p.id,r,p),this.enemies.push(M)),s.genHpNum(M,r)}s.init_total_hp(t,r)},s.reset=function(){this.allies=[],this.enemies=[]},r}(c))||m);r._RF.pop()}}}));

System.register("chunks:///_virtual/Generator.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Err.ts","./ResMgr.ts"],(function(t){"use strict";var e,r,n,a,o,i,s,c,u,f;return{setters:[function(t){e=t.defineProperty,r=t.inheritsLoose,n=t.assertThisInitialized},function(t){a=t.cclegacy,o=t._decorator,i=t.Prefab,s=t.instantiate,c=t.Component},function(t){u=t.Err},function(t){f=t.ResMgr}],execute:function(){var p,l,h;a._RF.push({},"c1bdbLZqfJGYpKF+oDpiY/3","Generator",void 0);var b=o.ccclass;o.property,t("Generator",b("Generator")((h=l=function(t){function a(r){var a;return a=t.call(this,r)||this,e(n(a),"prefab_map",new Map),f.loadDir("Prefab","/",i,(function(t){t.length<1?u.alert("No prefabs",a.name,"constructor"):t.forEach((function(t){a.prefab_map.set(t.data._name,t)}))}),a.name,"constructor"),a}return r(a,t),a.getInstance=function(){return a.ist||(a.ist=new a("Generator")),a.ist},a.prototype.generator=function(t,e,r){var n=this.prefab_map.get(e);if(!n)return u.alert("Prefab '"+e+"' doesn't exist",this.name,this.generator.name),null;var a=s(n);return a.parent=t,r&&a.setPosition(r),a},a}(c),e(l,"ist",null),p=h))||p);a._RF.pop()}}}));

System.register("chunks:///_virtual/Subscribe.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(e){"use strict";var t,n,r,i,c;return{setters:[function(e){t=e.defineProperty,n=e.inheritsLoose},function(e){r=e.cclegacy,i=e._decorator,c=e.Component}],execute:function(){var s,a,u;r._RF.push({},"c7475SI+L5ApZlKzyrWBCg8","Subscribe",void 0);var o=i.ccclass;i.property,e("Subscribe",o("Subscribe")((u=a=function(e){function t(){return e.apply(this,arguments)||this}return n(t,e),t.listen=function(e,t,n,r){var i=new Map;return this.client_map.has(e)&&(i=this.client_map.get(e)),!!i&&(r&&(n=n.bind(r)),i.set(t,n),this.client_map.set(e,i),!0)},t.trigger=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=this.client_map.get(e);if(!i)return!1;i.forEach((function(e){e.apply(e,n)}))},t.remove=function(e,t){var n=this.client_map.get(e);return!!n&&(t?(n.delete(t),!0):(this.client_map.delete(e),!0))},t.reset=function(){this.client_map.clear()},t}(c),t(a,"client_map",new Map),s=u))||s);r._RF.pop()}}}));

System.register("chunks:///_virtual/ShowNum.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(e){"use strict";var r,t,o,i,n,s,l,a,p,u,c,h;return{setters:[function(e){r=e.applyDecoratedDescriptor,t=e.inheritsLoose,o=e.initializerDefineProperty,i=e.assertThisInitialized,n=e.defineProperty},function(e){s=e.cclegacy,l=e._decorator,a=e.SpriteAtlas,p=e.Node,u=e.Sprite,c=e.Vec3,h=e.Component}],execute:function(){var d,m,v,f,g;s._RF.push({},"ca895hZD0dCirKjl8GhUAUn","ShowNum",void 0);var A=l.ccclass,y=l.property;e("ShowNum",(d=A("ShowNum"),m=y(a),d((g=r((f=function(e){function r(){for(var r,t=arguments.length,s=new Array(t),l=0;l<t;l++)s[l]=arguments[l];return r=e.call.apply(e,[this].concat(s))||this,o(i(r),"sprAtlas",g,i(r)),n(i(r),"_poolArr",[]),r}t(r,e);var s=r.prototype;return s.onLoad=function(){},s.getNodeFromPool=function(e){var r;return(0==this._poolArr.length||e+1>this._poolArr.length)&&((r=new p).addComponent(u),this._poolArr.push(r)),(r=this._poolArr[e])&&r.parent&&r.parent.removeChild(r),r},s.showNumber=function(e,r){if(void 0===r&&(r="num2-"),null!=this.sprAtlas){this.removeReset();for(var t,o,i=e.toString().split(""),n=0;n<i.length;n++){var s;t=this.getNodeFromPool(n),this.node.addChild(t);var l=t.getComponent(u);if(!l)return;o=l;var a=i[n];o.spriteFrame=this.sprAtlas.getSpriteFrame(r+a);var p=t.getPosition();if(!o.spriteFrame)return;t.setPosition(new c(((null===(s=o.spriteFrame)||void 0===s?void 0:s.rect.width)+2)*n,p.y,p.z))}}},s.removeReset=function(){this.node.removeAllChildren()},r}(h)).prototype,"sprAtlas",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=f))||v));s._RF.pop()}}}));

System.register("chunks:///_virtual/Formation.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Err.ts","./Subscribe.ts","./Configure.ts","./ResMgr.ts","./Generator.ts","./AlertLbl.ts","./Functions.ts","./HeroPortrait.ts","./HerosMgr.ts","./FormationBar.ts"],(function(t){"use strict";var o,i,e,r,s,n,h,a,_,c,f,d,l,m,p,u,g,v,F,S,b,C;return{setters:[function(t){o=t.inheritsLoose,i=t.defineProperty,e=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,n=t.Label,h=t.UITransform,a=t.v3,_=t.find,c=t.Component,f=t.Sprite,d=t.SpriteFrame},function(t){l=t.Err},function(t){m=t.Subscribe},function(t){p=t.Configure},function(t){u=t.ResMgr},function(t){g=t.Generator},function(t){v=t.AlertLbl},function(t){F=t.Functions},function(t){S=t.HeroPortrait},function(t){b=t.HerosMgr},function(t){C=t.FormationBar}],execute:function(){var x;r._RF.push({},"cce4fYZM+VNDJw8Mk3KktI5","Formation",void 0);var y=s.ccclass;s.property,t("Formation",y("Formation")(x=function(t){function r(){for(var o,r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];return o=t.call.apply(t,[this].concat(s))||this,i(e(o),"hero_root",null),i(e(o),"troop_conf",void 0),i(e(o),"formation_conf",void 0),i(e(o),"hero_map",new Map),i(e(o),"finish_btn",null),i(e(o),"alert_root",null),i(e(o),"max_selection",0),i(e(o),"selected_hero_ids",[]),i(e(o),"formation_name",null),i(e(o),"portrait_root",null),i(e(o),"portraits",[]),i(e(o),"bar_root",null),i(e(o),"curr_formation_id",""),i(e(o),"formation_ctrl_map",new Map),i(e(o),"formation_conf_map",new Map),i(e(o),"gen",null),i(e(o),"sort_map",new Map),i(e(o),"sort_type","str"),i(e(o),"heros_conf_map",new Map),i(e(o),"ids_sp",[]),i(e(o),"ids_nm",[]),i(e(o),"ids",[]),o}o(r,t);var s=r.prototype;return s.onLoad=function(){var t,o;if(this.gen=g.getInstance(),this.hero_root=this.node.getChildByPath("HeroView/view/content"),this.portrait_root=this.node.getChildByPath("Formation_Panel/Formation_Root"),this.formation_name=null===(t=this.node.getChildByPath("Formation_Panel/Name"))||void 0===t?void 0:t.getComponent(n),this.bar_root=this.node.getChildByPath("Formation_Select/FormationView/view/content"),this.alert_root=this.node.getChildByName("Alert_Root"),this.troop_conf=b.getInstance().getTroops(),this.formation_conf=this.troop_conf.formation,this.formation_name&&(this.formation_name.string=this.formation_conf.name),this.max_selection=this.formation_conf.pos_idxs.length,this.portrait_root){for(var i=0;i<this.max_selection;i++){var e=this.gen.generator(this.portrait_root,"Hero_portrait");e&&this.portraits.push(e)}this.curr_formation_id=this.formation_conf.id,this.setFormationBar(),this.finish_btn=this.node.getChildByName("Finish"),null===(o=this.finish_btn)||void 0===o||o.on("click",this.hide,this),m.listen("changeSpHero",this.name,this.changeSpHero,this),m.listen("change hero selected",this.name,this.changeSelected,this),m.listen("change formation",this.name,this.changeFormation,this),this.sort_map=new Map([["str",this.sortStr.bind(this)]]),this.sort_type="str",this.setHero()}},s.onEnable=function(){this.updateFormation(!0,!0)},s.setFormationBar=function(){var t=p.getConfigure("hero").common.formation;if(this.bar_root&&this.gen){var o=this.bar_root.getComponent(h);o&&o.setContentSize(o.contentSize.width,130*(t.length-1));for(var i=0;i<t.length;i++)if("monster"!==t[i].id){this.formation_conf_map.set(t[i].id,t[i]);var e=this.gen.generator(this.bar_root,"Formation_Bar",a(0,-130*i-75,0)),r=null==e?void 0:e.getComponent(C);r&&(r.init(t[i],this.curr_formation_id),this.formation_ctrl_map.set(t[i].id,r))}}},s.changeFormation=function(t){var o,i;null===(o=this.formation_ctrl_map.get(this.curr_formation_id))||void 0===o||o.changeState(!1),null===(i=this.formation_ctrl_map.get(t))||void 0===i||i.changeState(!0),this.curr_formation_id=t,this.formation_conf=this.formation_conf_map.get(t),this.updateFormation(!1,!0)},s.setHero=function(){for(var t=0;t<this.troop_conf.heros.length;t++)this.troop_conf.heros[t].idx=t,this.heros_conf_map.set(this.troop_conf.heros[t].id,this.troop_conf.heros[t]),this.troop_conf.heros[t].is_sp?this.ids_sp.push(this.troop_conf.heros[t].id):this.ids_nm.push(this.troop_conf.heros[t].id),this.troop_conf.heros[t].is_select&&this.selected_hero_ids.push(this.troop_conf.heros[t].id);this.sortStr();for(var o=0;o<this.ids.length;o++){if(!this.hero_root||!this.gen)return;var i,e=this.gen.generator(this.hero_root,"Hero_2D");if(e)null===(i=e.getComponent(S))||void 0===i||i.init(this.heros_conf_map.get(this.ids[o])),this.hero_map.set(this.ids[o],e)}},s.changeSelected=function(t,o,i){if(o){if(this.selected_hero_ids.length<=0)return;var e=this.selected_hero_ids.indexOf(t);this.selected_hero_ids.splice(e,1),this.troop_conf.heros[this.heros_conf_map.get(t).idx].is_select=!1}else{if(this.selected_hero_ids.length>=this.max_selection){var r,s,n=null===(r=_("Canvas"))||void 0===r?void 0:r.worldPosition,h=null===(s=this.hero_map.get(t))||void 0===s?void 0:s.worldPosition;if(this.alert_root&&n&&h){var c=a(h).subtract(n);v.getInstance().alert("编队武将数量已达上限！",this.alert_root,c)}return}this.selected_hero_ids.push(t),this.troop_conf.heros[this.heros_conf_map.get(t).idx].is_select=!0}i(),this.updateFormation(!0,!1)},s.updateFormation=function(t,o){var i=this;if(this.portrait_root&&this.selected_hero_ids&&this.formation_conf){if(this.portraits.length<this.selected_hero_ids.length&&l.console("Length of selected heros out of range!",this.name,this.updateFormation.name),t)for(var e=function(t){var o=i.portraits[t].getComponent(f);if(!o)return"continue";if(t>=i.selected_hero_ids.length)return o.spriteFrame=null,"continue";var e=i.heros_conf_map.get(i.selected_hero_ids[t]).hero_id;u.loadDir("Texture","Portrait/Hero/"+e,d,(function(t){o&&t&&(o.spriteFrame=t[0])}),i.name,i.updateFormation.name)},r=0;r<this.portraits.length;r++)e(r);if(o){for(var s=this.formation_conf.pos_idxs,n=p.getConfigure("hero").common.prePos,h=0;h<this.portraits.length;h++){var _=n.pos[s[h]],c=a(_[0]*n["2d_dist"],_[1]*n["2d_dist"],0);this.portraits[h].setPosition(c)}this.formation_name&&(this.formation_name.string=this.formation_conf.name)}}},s.changeSpHero=function(t,o){var i=this.heros_conf_map.get(t).idx;this.troop_conf.heros[i].is_sp=o;var e,r=[];if(o){var s=[this.ids_sp,this.ids_nm];e=s[0],r=s[1]}else{var n=[this.ids_nm,this.ids_sp];e=n[0],r=n[1]}var h=r.indexOf(t);r.splice(h,1),e.push(t),this.updateOder()},s.updateOder=function(){var t=this,o=this.sort_map.get(this.sort_type);o&&o(),this.hero_root&&(this.hero_root.removeAllChildren(),this.ids.forEach((function(o){var i=t.hero_map.get(o);i&&(i.parent=t.hero_root)})))},s.sortStr=function(){F.sortStr(this.ids_sp,0,this.ids_sp.length-1,0),F.sortStr(this.ids_nm,0,this.ids_nm.length-1,0),this.ids=this.ids_sp.concat(this.ids_nm)},s.hide=function(t){if(this.selected_hero_ids.length>0){for(var o=[],i=0;i<this.selected_hero_ids.length;i++)o.push({id:this.selected_hero_ids[i],idx:i});return this.formation_conf.ids_idxs=o,this.troop_conf.formation=this.formation_conf,m.trigger("update troop",this.troop_conf),void(this.node.active=!1)}this.alert_root&&v.getInstance().alert("请至少选择一位武将！",this.alert_root,t.node.getPosition())},r}(c))||x);r._RF.pop()}}}));

System.register("chunks:///_virtual/TotalHp.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Functions.ts"],(function(e){"use strict";var t,l,n,a,i,s,r,o,h,_;return{setters:[function(e){t=e.inheritsLoose,l=e.defineProperty,n=e.assertThisInitialized},function(e){a=e.cclegacy,i=e._decorator,s=e.ProgressBar,r=e.Label,o=e.tween,h=e.Component},function(e){_=e.Functions}],execute:function(){var y;a._RF.push({},"ec227kpjOhAIZgH4kkSzwsE","TotalHp",void 0);var p=i.ccclass;i.property,e("TotalHp",p("TotalHp")(y=function(e){function a(){for(var t,a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return t=e.call.apply(e,[this].concat(i))||this,l(n(t),"ally_bar",null),l(n(t),"enemy_bar",null),l(n(t),"ally_lbl",null),l(n(t),"enemy_lbl",null),l(n(t),"ally_max_hp",0),l(n(t),"ally_cur_hp",0),l(n(t),"enemy_max_hp",0),l(n(t),"enemy_cur_hp",0),t}t(a,e);var i=a.prototype;return i.onLoad=function(){var e,t,l,n,a,i;this.ally_bar=null===(e=this.node.getChildByName("AllyBar"))||void 0===e?void 0:e.getComponent(s),this.enemy_bar=null===(t=this.node.getChildByName("EnemyBar"))||void 0===t?void 0:t.getComponent(s),this.ally_lbl=null===(l=this.ally_bar)||void 0===l||null===(n=l.node.getChildByName("Label"))||void 0===n?void 0:n.getComponent(r),this.enemy_lbl=null===(a=this.enemy_bar)||void 0===a||null===(i=a.node.getChildByName("Label"))||void 0===i?void 0:i.getComponent(r)},i.set_hp=function(e,t){"ally"===t?(this.ally_max_hp=this.ally_cur_hp=e,this.ally_bar&&(this.ally_bar.progress=1)):"enemy"===t&&(this.enemy_max_hp=this.enemy_cur_hp=e,this.enemy_bar&&(this.enemy_bar.progress=1)),this.updateHp()},i.changeHp=function(e,t){"ally"===t?(this.ally_cur_hp+=e,this.ally_bar&&o(this.ally_bar).to(.2,{progress:this.ally_cur_hp/this.ally_max_hp},{easing:"sineInOut"}).start()):"enemy"===t&&(this.enemy_cur_hp+=e,this.enemy_bar&&o(this.enemy_bar).to(.2,{progress:this.enemy_cur_hp/this.enemy_max_hp},{easing:"sineInOut"}).start()),this.updateHp()},i.updateHp=function(){this.ally_lbl&&this.enemy_lbl&&(this.ally_lbl.string=_.numToStr(this.ally_cur_hp)+" / "+_.numToStr(this.ally_max_hp),this.enemy_lbl.string=_.numToStr(this.enemy_cur_hp)+" / "+_.numToStr(this.enemy_max_hp))},a}(h))||y);a._RF.pop()}}}));

System.register("chunks:///_virtual/FormationBar.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Subscribe.ts"],(function(i){"use strict";var t,n,e,o,s,r,a,l;return{setters:[function(i){t=i.inheritsLoose,n=i.defineProperty,e=i.assertThisInitialized},function(i){o=i.cclegacy,s=i._decorator,r=i.Label,a=i.Component},function(i){l=i.Subscribe}],execute:function(){var h;o._RF.push({},"f52116IUS1KzYfLVai/n5XV","FormationBar",void 0);var c=s.ccclass;s.property,i("FormationBar",c("FormationBar")(h=function(i){function o(){for(var t,o=arguments.length,s=new Array(o),r=0;r<o;r++)s[r]=arguments[r];return t=i.call.apply(i,[this].concat(s))||this,n(e(t),"name_lbl",null),n(e(t),"intro_lbl",null),n(e(t),"trigger",null),n(e(t),"point_dis",null),n(e(t),"point_en",null),n(e(t),"isEnable",!1),t}t(o,i);var s=o.prototype;return s.onLoad=function(){var i,t;this.name_lbl=null===(i=this.node.getChildByPath("Mask/Layout/Name"))||void 0===i?void 0:i.getComponent(r),this.intro_lbl=null===(t=this.node.getChildByPath("Mask/Layout/Introduce"))||void 0===t?void 0:t.getComponent(r),this.trigger=this.node.getChildByName("Trigger"),this.point_dis=this.node.getChildByName("Disable"),this.point_en=this.node.getChildByName("Enable")},s.init=function(i,t){var n=this;this.name_lbl&&(this.name_lbl.string=i.name+"："),this.intro_lbl&&(this.intro_lbl.string=i.introduce),this.trigger&&this.point_dis&&this.point_en&&(this.trigger.on("click",(function(){n.isEnable||l.trigger("change formation",i.id)})),this.point_dis.active=!0,this.point_en.active=!1,i.id==t&&(this.point_en.active=!0,this.point_dis.active=!1,this.isEnable=!0))},s.changeState=function(i){this.point_dis&&this.point_en&&(this.point_dis.active=!i,this.point_en.active=i,this.isEnable=i)},o}(a))||h);o._RF.pop()}}}));

System.register("chunks:///_virtual/start-scene",["./Err.ts","./Subscribe.ts","./Configure.ts","./ResMgr.ts","./Generator.ts","./AlertLbl.ts","./Functions.ts","./HpNum.ts","./MD5.ts","./LoginMsg.ts","./SignUp.ts","./Gesture.ts","./UserException.ts","./StageMgr.ts","./GameMgr.ts","./MoveCamera.ts","./ItemMgr.ts","./SceneMgr.ts","./Loading.ts","./MonsterMgr.ts","./MainScene.ts","./HeroPortrait.ts","./TotalHp.ts","./HpMgr.ts","./StageDetails.ts","./TouchScreen.ts","./BattleScene.ts","./HerosMgr.ts","./Test.ts","./StartScene.ts","./Json2Exc.ts","./StagePoint.ts","./NetWork.ts","./DmgCal.ts","./AtkMgr.ts","./Info.ts","./StageMaker.ts","./StageScene.ts","./BasicException.ts","./BattleFieldMaker.ts","./ShowNum.ts","./FormationBar.ts","./Formation.ts"],(function(){"use strict";return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

(function(r) {
  r('virtual:///prerequisite-imports/start-scene', 'chunks:///_virtual/start-scene'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});
//# sourceMappingURL=index.js.map