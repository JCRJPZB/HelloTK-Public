{"version":3,"sources":["file:///E:/GitHub/HelloTK/assets/Script/UI/MainScene/League/LeagueJoin.ts"],"names":["_decorator","Component","Sprite","Label","v3","PlayerMgr","ImgMgr","Subscribe","ccclass","property","LeagueJoin","onLoad","layout","node","getChildByName","trigger","flag","getChildByPath","getComponent","league_name","describe","member","join_btn","on","conf","getInstance","joinLeague","league_id","init","spriteFrame","getImg","string","toString"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, Sprite, Label, v3 } from 'cc';\r\nimport { PlayerMgr } from '../../../Player/PlayerMgr';\r\nimport { ImgMgr } from '../../../Tools/ImgMgr';\r\nimport { Subscribe } from '../../../Tools/Subscribe';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('LeagueJoin')\r\nexport class LeagueJoin extends Component {\r\n\r\n    private league_id: string = \"\";\r\n\r\n    private conf: any = null;\r\n\r\n    private flag: Sprite | null | undefined;\r\n    private league_name: Label | null | undefined;\r\n    private describe: Label | null | undefined;\r\n    private member: Label | null | undefined;\r\n    private join_btn: Node | null = null;\r\n\r\n    onLoad() {\r\n        let layout = this.node.getChildByName(\"Join_Layout\");\r\n        if (!layout) {\r\n            Subscribe.trigger(\"log err\", \"Can't find node named \\'Join_Layout\\'\");\r\n            return;\r\n        }\r\n        this.flag = layout.getChildByPath(\"Join_Flag\")?.getComponent(Sprite);\r\n        this.league_name = layout.getChildByPath(\"Join_Name\")?.getComponent(Label);\r\n        this.describe = layout.getChildByPath(\"Join_Describe\")?.getComponent(Label);\r\n        this.member = layout.getChildByPath(\"Join_Member\")?.getComponent(Label);\r\n        this.join_btn = layout.getChildByPath(\"Join_Btn\");\r\n        this.join_btn?.on(\"click\", () => {\r\n            if (this.conf && this.conf[\"num_of_member\"] < this.conf[\"max_member\"]) {\r\n                PlayerMgr.getInstance().joinLeague(this.league_id);\r\n                Subscribe.trigger(\"open UI\", \"LeagueInfo\", \"Window\");\r\n            } else if (this.conf && this.join_btn) {\r\n                Subscribe.trigger(\"alert UI\", \"该联盟已满员！\", this.join_btn, v3(-50, 0, 0));\r\n            }\r\n        });\r\n    }\r\n\r\n    public init(conf: any) {\r\n        this.conf = conf;\r\n        this.league_id = conf[\"league_id\"];\r\n        if (!this.flag || !this.league_name || !this.describe || !this.member || !this.join_btn) {\r\n            Subscribe.trigger(\"log err\", \"Node has not been inited yet!\");\r\n        }\r\n        if (this.flag) {\r\n            this.flag.spriteFrame = ImgMgr.getInstance().getImg(conf[\"flag\"]);\r\n            if (!this.flag.spriteFrame) {\r\n                Subscribe.trigger(\"log err\", \"Can't find image named \\'\" + conf[\"flag\"] + \"\\'\");\r\n            }\r\n        }\r\n        if (this.league_name) {\r\n            this.league_name.string = conf[\"league_name\"];\r\n        }\r\n        if (this.describe) {\r\n            this.describe.string = conf[\"describe\"];\r\n        }\r\n        if (this.member) {\r\n            this.member.string = conf[\"num_of_member\"].toString() + \"/\" + conf[\"max_member\"].toString();\r\n        }\r\n    }\r\n}\r\n"]}