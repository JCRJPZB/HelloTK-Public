{"version":3,"sources":["file:///E:/GitHub/HelloTK/assets/Script/BattleField/Attack/DmgCal.ts"],"names":["_decorator","Component","Configure","Subscribe","ccclass","property","DmgCal","onLoad","listen","name","init","settings","getConfigure","max_dmg_ratio","min_dmg_ratio","base_cri_dmg_rate","base_blk_dmg_rate","calculate","atker","defer","atk","getConf","def","max","a","b","min"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;;AACZC,MAAAA,S,iBAAAA,S;;AACAC,MAAAA,S,iBAAAA,S;;;;;;;OAEH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBL,U;;wBAGjBM,M,WADZF,OAAO,CAAC,QAAD,C,mCAAR,MACaE,MADb,SAC4BL,SAD5B,CACsC;AAWlC;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEAM,QAAAA,MAAM,GAAG;AACL;AACA;AAAA;AAAA,sCAAUC,MAAV,CAAiB,iBAAjB,EAAoC,KAAKC,IAAzC,EAA+CH,MAAM,CAACI,IAAtD,EAA4D,IAA5D;AACH;;AAEiB,eAAJA,IAAI,GAAG;AACjB,cAAIC,QAAQ,GAAG;AAAA;AAAA,sCAAUC,YAAV,CAAuB,SAAvB,EAAkC,QAAlC,CAAf;AACAN,UAAAA,MAAM,CAACO,aAAP,GAAuBF,QAAQ,CAAC,eAAD,CAA/B;AACAL,UAAAA,MAAM,CAACQ,aAAP,GAAuBH,QAAQ,CAAC,eAAD,CAA/B;AACAL,UAAAA,MAAM,CAACS,iBAAP,GAA2BJ,QAAQ,CAAC,mBAAD,CAAnC;AACAL,UAAAA,MAAM,CAACU,iBAAP,GAA2BL,QAAQ,CAAC,mBAAD,CAAnC;AACH;;AAEsB,eAATM,SAAS,CAACC,KAAD,EAAcC,KAAd,EAAoC;AACvD;AACA;AACA,cAAIC,GAAG,GAAGF,KAAK,CAACG,OAAN,CAAc,KAAd,CAAV;AACA,cAAIC,GAAG,GAAGH,KAAK,CAACE,OAAN,CAAc,KAAd,CAAV;AACA,iBAAOD,GAAG,GAAGE,GAAb,CALuD,CAMvD;AACH;;AAEiB,eAAHC,GAAG,CAACC,CAAD,EAAYC,CAAZ,EAAuB;AAAE,iBAAOD,CAAC,GAAGC,CAAJ,GAAQD,CAAR,GAAYC,CAAnB;AAAuB;;AAEhD,eAAHC,GAAG,CAACF,CAAD,EAAYC,CAAZ,EAAuB;AAAE,iBAAOD,CAAC,GAAGC,CAAJ,GAAQA,CAAR,GAAYD,CAAnB;AAAuB;;AA7ChC,O,4CAEK,C,6CACA,C,iDACI,C,iDACA,C,yCAER,C,uCACF,C,yCACE,C","sourcesContent":["import { _decorator, Component } from 'cc';\r\nimport { Configure } from '../../Tools/Configure';\r\nimport { Subscribe } from '../../Tools/Subscribe';\r\nimport { Info } from './Info';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('DmgCal')\r\nexport class DmgCal extends Component {\r\n\r\n    private static max_dmg_ratio: number = 0;\r\n    private static min_dmg_ratio: number = 0;\r\n    private static base_cri_dmg_rate: number = 0;\r\n    private static base_blk_dmg_rate: number = 0;\r\n\r\n    private static attr_diff: number = 0;\r\n    private static counter: number = 0;\r\n    private static tech_diff: number = 0;\r\n\r\n    // private static skill_gain: number = 0;\r\n    // private static crt_gain: number = 0;\r\n    // private static form_gain: number = 0;\r\n    // private static other_gain: number = 0;\r\n\r\n    // private static blk_reduce: number = 0;\r\n    // private static skill_reduce: number = 0;\r\n    // private static form_reduce: number = 0;\r\n    // private static other_reduce: number = 0;\r\n\r\n    onLoad() {\r\n        // find(\"/SafeArea\")?.on(\"settings loaded\", DmgCal.init, this);\r\n        Subscribe.listen(\"settings loaded\", this.name, DmgCal.init, this);\r\n    }\r\n\r\n    public static init() {\r\n        let settings = Configure.getConfigure(\"soldier\")[\"common\"];\r\n        DmgCal.max_dmg_ratio = settings[\"max_dmg_ratio\"];\r\n        DmgCal.min_dmg_ratio = settings[\"min_dmg_ratio\"];\r\n        DmgCal.base_cri_dmg_rate = settings[\"base_cri_dmg_rate\"];\r\n        DmgCal.base_blk_dmg_rate = settings[\"base_blk_dmg_rate\"];\r\n    }\r\n\r\n    public static calculate(atker: Info, defer: Info): number  {\r\n        // ###########################################\r\n        // 本地测试阶段，暂时简单按减法计算伤害\r\n        let atk = atker.getConf(\"atk\");\r\n        let def = defer.getConf(\"def\");\r\n        return atk - def;\r\n        // ###########################################\r\n    }\r\n\r\n    private static max(a: number, b: number) { return a > b ? a : b; }\r\n\r\n    private static min(a: number, b: number) { return a > b ? b : a; }\r\n\r\n}\r\n"]}