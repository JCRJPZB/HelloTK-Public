{"version":3,"sources":["file:///E:/GitHub/HelloTK/assets/Script/UI/MainScene/League/LeagueList.ts"],"names":["_decorator","Functions","Generator","Subscribe","UIBase","LeagueJoin","LeagueMgr","ccclass","property","LeagueList","onInit","leagueMgr","getInstance","gen","list_root","getNode","listen","name","league_id","pid","trigger","onOpen","refreshList","league_list","getLeagueList","length","removeAllChildren","display_list","randomFromArray","forEach","league","league_node","generator","ctrl","getComponent","init"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;;AACAC,MAAAA,S,iBAAAA,S;;AACAC,MAAAA,S,iBAAAA,S;;AACAC,MAAAA,S,iBAAAA,S;;AACAC,MAAAA,M,iBAAAA,M;;AACAC,MAAAA,U,iBAAAA,U;;AACAC,MAAAA,S,iBAAAA,S;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBR,U;;4BAGjBS,U,WADZF,OAAO,CAAC,YAAD,C,yBAAR,MACaE,UADb;AAAA;AAAA,4BACuC;AAAA;AAAA;;AAAA;;AAAA;;AAAA;AAAA;;AAMzBC,QAAAA,MAAM,GAAG;AACf,eAAKC,SAAL,GAAiB;AAAA;AAAA,sCAAUC,WAAV,EAAjB;AACA,eAAKC,GAAL,GAAW;AAAA;AAAA,sCAAUD,WAAV,EAAX;AACA,eAAKE,SAAL,GAAiB,KAAKC,OAAL,CAAa,cAAb,CAAjB;AACA;AAAA;AAAA,sCAAUC,MAAV,CAAiB,oBAAjB,EAAuC,KAAKC,IAA5C,EAAkD,CAACC,SAAD,EAAoBC,GAApB,KAAoC;AAClF;AAAA;AAAA,wCAAUC,OAAV,CAAkB,UAAlB,EAA8B,YAA9B,EAA4C,QAA5C;AACH,WAFD;AAGH;;AAESC,QAAAA,MAAM,GAAG;AACf,eAAKC,WAAL;AACH;;AAEOA,QAAAA,WAAW,GAAG;AAAA;;AAClB,cAAI,CAAC,KAAKX,SAAV,EAAqB;AACjB,iBAAKA,SAAL,GAAiB;AAAA;AAAA,wCAAUC,WAAV,EAAjB;AACH;;AACD,cAAIW,WAAW,GAAG,KAAKZ,SAAL,CAAea,aAAf,EAAlB;;AACA,cAAI,CAACD,WAAD,IAAgBA,WAAW,CAACE,MAAZ,GAAqB,CAAzC,EAA4C;AACxC;AAAA;AAAA,wCAAUL,OAAV,CAAkB,SAAlB,EAA6B,yBAA7B;AACH;;AACD,kCAAKN,SAAL,oEAAgBY,iBAAhB;AACA,cAAIC,YAAY,GAAG;AAAA;AAAA,sCAAUC,eAAV,CAA0BL,WAA1B,EAAuC,EAAvC,CAAnB;AACAI,UAAAA,YAAY,CAACE,OAAb,CAAqBC,MAAM,IAAI;AAC3B,gBAAI,CAAC,KAAKjB,GAAN,IAAa,CAAC,KAAKC,SAAvB,EAAkC;AAC9B,mBAAKD,GAAL,GAAW;AAAA;AAAA,0CAAUD,WAAV,EAAX;AACA,mBAAKE,SAAL,GAAiB,KAAKC,OAAL,CAAa,cAAb,CAAjB;AACH;;AACD,gBAAI,CAAC,KAAKD,SAAV,EAAqB;AACjB;AAAA;AAAA,0CAAUM,OAAV,CAAkB,SAAlB,EAA6B,yCAA7B;AACA;AACH;;AACD,gBAAIW,WAAW,GAAG,KAAKlB,GAAL,CAASmB,SAAT,CAAmB,KAAKlB,SAAxB,EAAmC,aAAnC,CAAlB;AACA,gBAAImB,IAAI,GAAGF,WAAH,aAAGA,WAAH,uBAAGA,WAAW,CAAEG,YAAb;AAAA;AAAA,yCAAX;;AACA,gBAAI,CAACD,IAAL,EAAW;AACP;AAAA;AAAA,0CAAUb,OAAV,CAAkB,SAAlB,EAA6B,uCAA7B;AACA;AACH;;AACDa,YAAAA,IAAI,CAACE,IAAL,CAAUL,MAAV;AACH,WAhBD;AAiBH;;AA9CkC,O","sourcesContent":["import { _decorator, Node } from 'cc';\r\nimport { Functions } from '../../../Tools/Functions';\r\nimport { Generator } from '../../../Tools/Generator';\r\nimport { Subscribe } from '../../../Tools/Subscribe';\r\nimport { UIBase } from '../../UIBase';\r\nimport { LeagueJoin } from './LeagueJoin';\r\nimport { LeagueMgr } from './LeagueMgr';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('LeagueList')\r\nexport class LeagueList extends UIBase {\r\n\r\n    private list_root: Node | undefined;\r\n    private leagueMgr: LeagueMgr | undefined;\r\n    private gen: Generator | undefined;\r\n\r\n    protected onInit() {\r\n        this.leagueMgr = LeagueMgr.getInstance();\r\n        this.gen = Generator.getInstance();\r\n        this.list_root = this.getNode(\"List_Content\");\r\n        Subscribe.listen(\"player join league\", this.name, (league_id: string, pid: string) => {\r\n            Subscribe.trigger(\"close UI\", \"LeagueList\", \"Window\");\r\n        });\r\n    }\r\n\r\n    protected onOpen() {\r\n        this.refreshList();\r\n    }\r\n\r\n    private refreshList() {\r\n        if (!this.leagueMgr) {\r\n            this.leagueMgr = LeagueMgr.getInstance();\r\n        }\r\n        let league_list = this.leagueMgr.getLeagueList();\r\n        if (!league_list || league_list.length < 1) {\r\n            Subscribe.trigger(\"log err\", \"Get league list failed!\");\r\n        }\r\n        this.list_root?.removeAllChildren();\r\n        let display_list = Functions.randomFromArray(league_list, 10);\r\n        display_list.forEach(league => {\r\n            if (!this.gen || !this.list_root) {\r\n                this.gen = Generator.getInstance();\r\n                this.list_root = this.getNode(\"List_Content\");\r\n            }\r\n            if (!this.list_root) {\r\n                Subscribe.trigger(\"log err\", \"Can't find node named \\'List_Content\\'.\");\r\n                return;\r\n            }\r\n            let league_node = this.gen.generator(this.list_root, \"League_Join\");\r\n            let ctrl = league_node?.getComponent(LeagueJoin);\r\n            if (!ctrl) {\r\n                Subscribe.trigger(\"log err\", \"Can't find comp named \\'LeagueJoin\\'.\");\r\n                return;\r\n            }\r\n            ctrl.init(league);\r\n        });\r\n    }\r\n}\r\n"]}