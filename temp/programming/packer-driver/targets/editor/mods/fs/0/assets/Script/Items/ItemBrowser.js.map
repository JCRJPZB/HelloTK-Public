{"version":3,"sources":["file:///E:/GitHub/HelloTK/assets/Script/Items/ItemBrowser.ts"],"names":["_decorator","Component","Label","Sprite","Functions","Generator","ImgMgr","Subscribe","Item","ccclass","property","ItemBrowser","onLoad","imgMgr","getInstance","gen","quit_btn","node","getChildByName","return_btn","getChildByPath","blockInput","use_btn","item_bg","getComponent","item_sp","item_name_lbl","item_num_lbl","describe","access_root","use_UI_node","use_UI_confirm","use_UI_cancel","use_UI_quit","use_item_node","use_item_name","use_item_describe","use_item_reduce_btn","use_item_reduce_disable_btn","use_item_num_lbl","use_item_add_btn","use_item_add_disable_btn","use_item_max_btn","active","trigger","init","data","item_num","string","numToStr","spriteFrame","getImg","forEach","access","new_access","generator","access_name_lbl","on","destroy","openUseUI","genUseUI","use_item_num","refreshUseNum","hideUseUI","parent","useItem","bind","normalize","flag","ifUse"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, Label, Sprite } from 'cc';\r\nimport { Functions } from '../Tools/Functions';\r\nimport { Generator } from '../Tools/Generator';\r\nimport { ImgMgr } from '../Tools/ImgMgr';\r\nimport { Subscribe } from '../Tools/Subscribe';\r\nimport { Item } from './Item';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('ItemBrowser')\r\nexport class ItemBrowser extends Component {\r\n\r\n    private imgMgr: ImgMgr | null = null;\r\n    private gen: Generator | null = null;\r\n\r\n    private data: any = null;\r\n\r\n    private blockInput: Node | null = null;\r\n    private quit_btn: Node | null = null;\r\n    private return_btn: Node | null = null;\r\n    private use_btn: Node | null = null;\r\n\r\n    private item_bg: Sprite | null | undefined = null;\r\n    private item_sp: Sprite | null | undefined = null;\r\n    private item_name_lbl: Label | null | undefined = null;\r\n    private item_num_lbl: Label | null | undefined = null;\r\n    private item_num: number = 0;\r\n\r\n    private describe: Label | null | undefined = null;\r\n    private access_root: Node | null = null;\r\n\r\n    private use_UI_node: Node | null = null;\r\n    private use_UI_confirm: Node | null = null;\r\n    private use_UI_cancel: Node | null = null;\r\n    private use_UI_quit: Node | null = null;\r\n    private use_item_node: Node | null = null;\r\n    private use_item_name: Label | null | undefined = null;\r\n    private use_item_describe: Label | null | undefined = null;\r\n    private use_item_reduce_btn: Node | null = null;\r\n    private use_item_reduce_disable_btn: Node | null = null;\r\n    private use_item_num_lbl: Label | null | undefined = null;\r\n    private use_item_add_btn: Node | null = null;\r\n    private use_item_add_disable_btn: Node | null = null;\r\n    private use_item_max_btn: Node | null = null;\r\n    private use_item_num: number = 0;\r\n\r\n    onLoad() {\r\n        this.imgMgr = ImgMgr.getInstance();\r\n        this.gen = Generator.getInstance();\r\n\r\n        this.quit_btn = this.node.getChildByName(\"Quit_Btn\");\r\n        this.return_btn = this.node.getChildByPath(\"Btn_Root/Quit_Btn\");\r\n        this.blockInput = this.node.getChildByName(\"BlockInput\");\r\n        this.use_btn = this.node.getChildByPath(\"Btn_Root/Use_Btn\");\r\n        this.item_bg = this.node.getChildByPath(\"Item/Bg\")?.getComponent(Sprite);\r\n        this.item_sp = this.node.getChildByPath(\"Item/Sprite\")?.getComponent(Sprite);\r\n        this.item_name_lbl = this.node.getChildByPath(\"Item/Name\")?.getComponent(Label);\r\n        this.item_num_lbl = this.node.getChildByPath(\"Item/Number\")?.getComponent(Label);\r\n\r\n        this.describe = this.node.getChildByName(\"Describe\")?.getComponent(Label);\r\n        this.access_root = this.node.getChildByPath(\"AccessView/view/content\");\r\n\r\n        this.use_UI_node = this.node.getChildByName(\"UseUI\");\r\n        if (this.use_UI_node) {\r\n            this.use_UI_confirm = this.use_UI_node.getChildByPath(\"Btns/Confirm\");\r\n            this.use_UI_cancel = this.use_UI_node.getChildByPath(\"Btns/Cancel\");\r\n            this.use_UI_quit = this.use_UI_node.getChildByName(\"BlockInput\");\r\n            this.use_item_node = this.use_UI_node.getChildByName(\"Item\");\r\n            this.use_item_name = this.use_UI_node.getChildByName(\"Name\")?.getComponent(Label);\r\n            this.use_item_describe = this.use_UI_node.getChildByName(\"Describe\")?.getComponent(Label);\r\n            this.use_item_reduce_btn = this.use_UI_node.getChildByPath(\"Layout/Reduce\");\r\n            this.use_item_reduce_disable_btn = this.use_UI_node.getChildByPath(\"Layout/Reduce_disable\");\r\n            this.use_item_num_lbl = this.use_UI_node.getChildByPath(\"Layout/Num_Lbl\")?.getComponent(Label);\r\n            this.use_item_add_btn = this.use_UI_node.getChildByPath(\"Layout/Add\");\r\n            this.use_item_add_disable_btn = this.use_UI_node.getChildByPath(\"Layout/Add_disable\");\r\n            this.use_item_max_btn = this.use_UI_node.getChildByPath(\"Layout/Max\");\r\n            this.use_UI_node.active = false;\r\n        } else { Subscribe.trigger(\"log err\", \"ItemBrowser init failed!\"); }\r\n    }\r\n\r\n    public init(data: any) {\r\n        this.data = data;\r\n        this.item_num = this.data[\"num\"];\r\n        if (this.item_name_lbl && this.describe && this.item_num_lbl) {\r\n            this.item_name_lbl.string = this.data[\"name\"];\r\n            this.describe.string = this.data[\"describe\"];\r\n            this.item_num_lbl.string = Functions.numToStr(this.item_num);\r\n        }\r\n        if (this.item_bg && this.item_sp && this.imgMgr) {\r\n            this.item_bg.spriteFrame = this.imgMgr.getImg(\"Item_Bg_\" + this.data[\"rare\"]);\r\n            this.item_sp.spriteFrame = this.imgMgr.getImg(this.data[\"img\"]);\r\n        }\r\n        if (this.data[\"access\"]) { // 生成item来源Label\r\n            this.data[\"access\"].forEach((access: string) => {\r\n                if (!this.access_root || !this.gen) { Subscribe.trigger(\"log err\", \"ItemBrowser init failed!\"); return; }\r\n                let new_access = this.gen.generator(this.access_root, \"Item_Access\");\r\n                let access_name_lbl = new_access?.getChildByName(\"Name\")?.getComponent(Label);\r\n                if (access_name_lbl) { access_name_lbl.string = access; }\r\n            });\r\n        }\r\n        this.quit_btn?.on(\"click\", () => { this.node.destroy(); });\r\n        this.return_btn?.on(\"click\", () => { this.node.destroy(); });\r\n        this.blockInput?.on(\"click\", () => { this.node.destroy(); });\r\n        if (this.data[\"able_to_use\"]) { // 可以使用的item添加使用按钮及其回调事件\r\n            this.use_btn!.active = true;\r\n            this.use_btn?.on(\"click\", () => { this.openUseUI(); });\r\n        } else { this.use_btn!.active = false; }\r\n        if (this.use_UI_node) { this.use_UI_node.active = false; }\r\n        this.genUseUI();\r\n    }\r\n\r\n    private genUseUI() {\r\n        if (!this.use_UI_node) { Subscribe.trigger(\"log err\", \"ItemBrowser init failed!\"); return; }\r\n        this.use_item_node?.getComponent(Item)?.init(this.data, this.item_num);\r\n        if (this.use_item_name) { this.use_item_name.string = this.data[\"name\"]; }\r\n        if (this.use_item_describe) { this.use_item_describe.string = this.data[\"describe\"]; }\r\n        if (this.use_item_num_lbl) { this.use_item_num_lbl.string = \"1\"; }\r\n        this.use_item_num = 1;\r\n        this.use_item_reduce_btn?.on(\"click\", () => {\r\n            if (this.use_item_num > 1) { this.use_item_num--; }\r\n            this.refreshUseNum();\r\n        });\r\n        this.use_item_add_btn?.on(\"click\", () => {\r\n            if (this.use_item_num < this.item_num && this.use_item_num + 1 <= this.data[\"max_num_once\"]) {\r\n                this.use_item_num++;\r\n            }\r\n            this.refreshUseNum();\r\n        });\r\n        this.use_item_max_btn?.on(\"click\", () => {\r\n            this.use_item_num = this.item_num > this.data[\"max_num_once\"] ? this.data[\"max_num_once\"] : this.item_num;\r\n            this.refreshUseNum();\r\n        });\r\n        this.use_UI_quit?.on(\"click\", this.hideUseUI, this);\r\n        this.use_UI_cancel?.on(\"click\", this.hideUseUI, this);\r\n        this.use_UI_confirm?.on(\"click\", () => {\r\n            Subscribe.trigger(\"try use item\", this.data[\"id\"], -this.use_item_num, this.node.parent, this.useItem.bind(this));\r\n        });\r\n        this.refreshUseNum();\r\n    }\r\n\r\n    private openUseUI() {\r\n        if (!this.use_UI_node) { Subscribe.trigger(\"log err\", \"ItemBrowser init failed!\"); return; }\r\n        this.use_UI_node.active = true;\r\n    }\r\n\r\n    private refreshUseNum() {\r\n        this.use_item_num = Functions.normalize(this.use_item_num, 1, this.item_num);\r\n        if (this.use_item_num_lbl) {\r\n            this.use_item_num_lbl.string = Functions.numToStr(this.use_item_num);\r\n        }\r\n        if (this.use_item_reduce_btn && this.use_item_reduce_disable_btn) {\r\n            this.use_item_reduce_btn.active = this.use_item_num > 1;\r\n            this.use_item_reduce_disable_btn.active = this.use_item_num <= 1;\r\n        }\r\n        if (this.use_item_add_btn && this.use_item_add_disable_btn) {\r\n            let flag = this.use_item_num < this.item_num && this.use_item_num < this.data[\"max_num_once\"];\r\n            this.use_item_add_btn.active = flag;\r\n            this.use_item_add_disable_btn.active = !flag;\r\n        }\r\n    }\r\n\r\n    private useItem(ifUse: boolean) {\r\n        this.hideUseUI();\r\n        if (!ifUse) { return; }\r\n        this.use_item_num = Functions.normalize(this.use_item_num, 1, this.item_num);\r\n        Subscribe.trigger(\"use item\", this.data[\"id\"], -this.use_item_num);\r\n        this.item_num -= this.use_item_num;\r\n        if (this.item_num_lbl) { this.item_num_lbl.string = Functions.numToStr(this.item_num); }\r\n        this.use_item_num = 1;\r\n        this.refreshUseNum();\r\n    }\r\n\r\n    private hideUseUI() {\r\n        if (this.use_UI_node) { this.use_UI_node.active = false; }\r\n    }\r\n}\r\n"]}